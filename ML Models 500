{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/harshyadav02/lgbm-for-both-defog-tdcsfog?scriptVersionId=154989854\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"7b553f3f","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:37:24.297572Z","iopub.status.busy":"2023-12-14T11:37:24.29721Z","iopub.status.idle":"2023-12-14T11:37:24.467216Z","shell.execute_reply":"2023-12-14T11:37:24.466227Z"},"papermill":{"duration":0.194241,"end_time":"2023-12-14T11:37:24.470041","exception":false,"start_time":"2023-12-14T11:37:24.2758","status":"completed"},"tags":[]},"outputs":[],"source":["# import library\n","import os\n","import random\n","import cv2\n","import pandas as pd\n","import numpy as np"]},{"cell_type":"markdown","id":"0e70cf41","metadata":{"papermill":{"duration":0.017965,"end_time":"2023-12-14T11:37:24.507023","exception":false,"start_time":"2023-12-14T11:37:24.489058","status":"completed"},"tags":[]},"source":["## Pre-processing (DEFOG)üè°"]},{"cell_type":"code","execution_count":2,"id":"98e32b9d","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:37:24.546302Z","iopub.status.busy":"2023-12-14T11:37:24.545921Z","iopub.status.idle":"2023-12-14T11:38:18.160057Z","shell.execute_reply":"2023-12-14T11:38:18.158854Z"},"papermill":{"duration":53.662219,"end_time":"2023-12-14T11:38:18.187381","exception":false,"start_time":"2023-12-14T11:37:24.525162","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Time</th>\n","      <th>AccV</th>\n","      <th>AccML</th>\n","      <th>AccAP</th>\n","      <th>StartHesitation</th>\n","      <th>Turn</th>\n","      <th>Walking</th>\n","      <th>Valid</th>\n","      <th>Task</th>\n","      <th>file</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-1.002697</td>\n","      <td>0.022371</td>\n","      <td>0.068304</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>be9d33541d</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>-1.002641</td>\n","      <td>0.019173</td>\n","      <td>0.066162</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>be9d33541d</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>-0.999820</td>\n","      <td>0.019142</td>\n","      <td>0.067536</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>be9d33541d</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>-0.998023</td>\n","      <td>0.018378</td>\n","      <td>0.068409</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>be9d33541d</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>-0.998359</td>\n","      <td>0.016726</td>\n","      <td>0.066448</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>be9d33541d</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>109120</th>\n","      <td>109120</td>\n","      <td>-0.939241</td>\n","      <td>0.031564</td>\n","      <td>-0.394737</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>06414383cf</td>\n","    </tr>\n","    <tr>\n","      <th>109121</th>\n","      <td>109121</td>\n","      <td>-0.941096</td>\n","      <td>0.031582</td>\n","      <td>-0.392626</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>06414383cf</td>\n","    </tr>\n","    <tr>\n","      <th>109122</th>\n","      <td>109122</td>\n","      <td>-0.940131</td>\n","      <td>0.029092</td>\n","      <td>-0.394385</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>06414383cf</td>\n","    </tr>\n","    <tr>\n","      <th>109123</th>\n","      <td>109123</td>\n","      <td>-0.939872</td>\n","      <td>0.028058</td>\n","      <td>-0.398664</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>06414383cf</td>\n","    </tr>\n","    <tr>\n","      <th>109124</th>\n","      <td>109124</td>\n","      <td>-0.939006</td>\n","      <td>0.026628</td>\n","      <td>-0.398454</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>False</td>\n","      <td>False</td>\n","      <td>06414383cf</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>13525702 rows √ó 10 columns</p>\n","</div>"],"text/plain":["          Time      AccV     AccML     AccAP  StartHesitation  Turn  Walking  \\\n","0            0 -1.002697  0.022371  0.068304                0     0        0   \n","1            1 -1.002641  0.019173  0.066162                0     0        0   \n","2            2 -0.999820  0.019142  0.067536                0     0        0   \n","3            3 -0.998023  0.018378  0.068409                0     0        0   \n","4            4 -0.998359  0.016726  0.066448                0     0        0   \n","...        ...       ...       ...       ...              ...   ...      ...   \n","109120  109120 -0.939241  0.031564 -0.394737                0     0        0   \n","109121  109121 -0.941096  0.031582 -0.392626                0     0        0   \n","109122  109122 -0.940131  0.029092 -0.394385                0     0        0   \n","109123  109123 -0.939872  0.028058 -0.398664                0     0        0   \n","109124  109124 -0.939006  0.026628 -0.398454                0     0        0   \n","\n","        Valid   Task        file  \n","0       False  False  be9d33541d  \n","1       False  False  be9d33541d  \n","2       False  False  be9d33541d  \n","3       False  False  be9d33541d  \n","4       False  False  be9d33541d  \n","...       ...    ...         ...  \n","109120  False  False  06414383cf  \n","109121  False  False  06414383cf  \n","109122  False  False  06414383cf  \n","109123  False  False  06414383cf  \n","109124  False  False  06414383cf  \n","\n","[13525702 rows x 10 columns]"]},"execution_count":2,"metadata":{},"output_type":"execute_result"}],"source":["#reference: https://www.kaggle.com/code/ghrangel/read-data-and-merge\n","\n","DATA_ROOT_DEFOG = '/kaggle/input/tlvmc-parkinsons-freezing-gait-prediction/train/defog/'\n","defog = pd.DataFrame()\n","for root, dirs, files in os.walk(DATA_ROOT_DEFOG):\n","    for name in files:       \n","        f = os.path.join(root, name)\n","        df_list= pd.read_csv(f)\n","        df_list['file']= name.split('.')[0]\n","        defog = pd.concat([defog, df_list], axis=0)\n","\n","defog"]},{"cell_type":"code","execution_count":3,"id":"46d6c075","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:18.226475Z","iopub.status.busy":"2023-12-14T11:38:18.225705Z","iopub.status.idle":"2023-12-14T11:38:18.869789Z","shell.execute_reply":"2023-12-14T11:38:18.868451Z"},"papermill":{"duration":0.668103,"end_time":"2023-12-14T11:38:18.873531","exception":false,"start_time":"2023-12-14T11:38:18.205428","status":"completed"},"tags":[]},"outputs":[],"source":["defog = defog[(defog['Task']==1)&(defog['Valid']==1)]"]},{"cell_type":"code","execution_count":4,"id":"87cae9c2","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:18.922538Z","iopub.status.busy":"2023-12-14T11:38:18.921446Z","iopub.status.idle":"2023-12-14T11:38:18.929053Z","shell.execute_reply":"2023-12-14T11:38:18.927692Z"},"papermill":{"duration":0.033435,"end_time":"2023-12-14T11:38:18.931789","exception":false,"start_time":"2023-12-14T11:38:18.898354","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["the shape of defog dataset is (4090530, 10)\n"]}],"source":["print('the shape of defog dataset is {}'.format(defog.shape))"]},{"cell_type":"markdown","id":"47cf7613","metadata":{"papermill":{"duration":0.021174,"end_time":"2023-12-14T11:38:18.974606","exception":false,"start_time":"2023-12-14T11:38:18.953432","status":"completed"},"tags":[]},"source":["##  Combining it with üè°defog-metadata."]},{"cell_type":"code","execution_count":5,"id":"d47f07ee","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:19.018858Z","iopub.status.busy":"2023-12-14T11:38:19.017691Z","iopub.status.idle":"2023-12-14T11:38:19.043626Z","shell.execute_reply":"2023-12-14T11:38:19.042551Z"},"papermill":{"duration":0.050276,"end_time":"2023-12-14T11:38:19.046544","exception":false,"start_time":"2023-12-14T11:38:18.996268","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Id</th>\n","      <th>Subject</th>\n","      <th>Visit</th>\n","      <th>Medication</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>02ab235146</td>\n","      <td>e1f62e</td>\n","      <td>2</td>\n","      <td>on</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>02ea782681</td>\n","      <td>ae2d35</td>\n","      <td>2</td>\n","      <td>on</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>06414383cf</td>\n","      <td>8c1f5e</td>\n","      <td>2</td>\n","      <td>off</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>092b4c1819</td>\n","      <td>2874c5</td>\n","      <td>1</td>\n","      <td>off</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0a900ed8a2</td>\n","      <td>0e3d49</td>\n","      <td>2</td>\n","      <td>on</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>132</th>\n","      <td>f3a921edee</td>\n","      <td>1a778d</td>\n","      <td>1</td>\n","      <td>off</td>\n","    </tr>\n","    <tr>\n","      <th>133</th>\n","      <td>f40e8c6ebe</td>\n","      <td>575c60</td>\n","      <td>1</td>\n","      <td>off</td>\n","    </tr>\n","    <tr>\n","      <th>134</th>\n","      <td>f8ddbdd98d</td>\n","      <td>107712</td>\n","      <td>1</td>\n","      <td>on</td>\n","    </tr>\n","    <tr>\n","      <th>135</th>\n","      <td>f9efef91fb</td>\n","      <td>5d9cae</td>\n","      <td>2</td>\n","      <td>off</td>\n","    </tr>\n","    <tr>\n","      <th>136</th>\n","      <td>f9fc61ce85</td>\n","      <td>040587</td>\n","      <td>1</td>\n","      <td>on</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>137 rows √ó 4 columns</p>\n","</div>"],"text/plain":["             Id Subject  Visit Medication\n","0    02ab235146  e1f62e      2         on\n","1    02ea782681  ae2d35      2         on\n","2    06414383cf  8c1f5e      2        off\n","3    092b4c1819  2874c5      1        off\n","4    0a900ed8a2  0e3d49      2         on\n","..          ...     ...    ...        ...\n","132  f3a921edee  1a778d      1        off\n","133  f40e8c6ebe  575c60      1        off\n","134  f8ddbdd98d  107712      1         on\n","135  f9efef91fb  5d9cae      2        off\n","136  f9fc61ce85  040587      1         on\n","\n","[137 rows x 4 columns]"]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["defog_metadata = pd.read_csv(\"/kaggle/input/tlvmc-parkinsons-freezing-gait-prediction/defog_metadata.csv\")\n","defog_metadata"]},{"cell_type":"code","execution_count":6,"id":"5daae510","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:19.087865Z","iopub.status.busy":"2023-12-14T11:38:19.08743Z","iopub.status.idle":"2023-12-14T11:38:21.602936Z","shell.execute_reply":"2023-12-14T11:38:21.601828Z"},"papermill":{"duration":2.539048,"end_time":"2023-12-14T11:38:21.605581","exception":false,"start_time":"2023-12-14T11:38:19.066533","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Id</th>\n","      <th>Subject</th>\n","      <th>Visit</th>\n","      <th>Medication</th>\n","      <th>Time</th>\n","      <th>AccV</th>\n","      <th>AccML</th>\n","      <th>AccAP</th>\n","      <th>StartHesitation</th>\n","      <th>Turn</th>\n","      <th>Walking</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>02ea782681</td>\n","      <td>ae2d35</td>\n","      <td>2</td>\n","      <td>on</td>\n","      <td>1000</td>\n","      <td>-0.970018</td>\n","      <td>0.061626</td>\n","      <td>-0.265625</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>02ea782681</td>\n","      <td>ae2d35</td>\n","      <td>2</td>\n","      <td>on</td>\n","      <td>1001</td>\n","      <td>-0.984375</td>\n","      <td>0.044497</td>\n","      <td>-0.265625</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>02ea782681</td>\n","      <td>ae2d35</td>\n","      <td>2</td>\n","      <td>on</td>\n","      <td>1002</td>\n","      <td>-0.984375</td>\n","      <td>0.029016</td>\n","      <td>-0.265625</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>02ea782681</td>\n","      <td>ae2d35</td>\n","      <td>2</td>\n","      <td>on</td>\n","      <td>1003</td>\n","      <td>-0.984375</td>\n","      <td>0.015625</td>\n","      <td>-0.265625</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>02ea782681</td>\n","      <td>ae2d35</td>\n","      <td>2</td>\n","      <td>on</td>\n","      <td>1004</td>\n","      <td>-0.984670</td>\n","      <td>0.015330</td>\n","      <td>-0.265625</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>4090525</th>\n","      <td>f9fc61ce85</td>\n","      <td>040587</td>\n","      <td>1</td>\n","      <td>on</td>\n","      <td>119027</td>\n","      <td>-0.961216</td>\n","      <td>0.142428</td>\n","      <td>-0.289655</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4090526</th>\n","      <td>f9fc61ce85</td>\n","      <td>040587</td>\n","      <td>1</td>\n","      <td>on</td>\n","      <td>119028</td>\n","      <td>-0.960343</td>\n","      <td>0.142836</td>\n","      <td>-0.290506</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4090527</th>\n","      <td>f9fc61ce85</td>\n","      <td>040587</td>\n","      <td>1</td>\n","      <td>on</td>\n","      <td>119029</td>\n","      <td>-0.957958</td>\n","      <td>0.145494</td>\n","      <td>-0.290007</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4090528</th>\n","      <td>f9fc61ce85</td>\n","      <td>040587</td>\n","      <td>1</td>\n","      <td>on</td>\n","      <td>119030</td>\n","      <td>-0.960616</td>\n","      <td>0.145839</td>\n","      <td>-0.291527</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4090529</th>\n","      <td>f9fc61ce85</td>\n","      <td>040587</td>\n","      <td>1</td>\n","      <td>on</td>\n","      <td>119031</td>\n","      <td>-0.967076</td>\n","      <td>0.144342</td>\n","      <td>-0.292384</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>4090530 rows √ó 11 columns</p>\n","</div>"],"text/plain":["                 Id Subject  Visit Medication    Time      AccV     AccML  \\\n","0        02ea782681  ae2d35      2         on    1000 -0.970018  0.061626   \n","1        02ea782681  ae2d35      2         on    1001 -0.984375  0.044497   \n","2        02ea782681  ae2d35      2         on    1002 -0.984375  0.029016   \n","3        02ea782681  ae2d35      2         on    1003 -0.984375  0.015625   \n","4        02ea782681  ae2d35      2         on    1004 -0.984670  0.015330   \n","...             ...     ...    ...        ...     ...       ...       ...   \n","4090525  f9fc61ce85  040587      1         on  119027 -0.961216  0.142428   \n","4090526  f9fc61ce85  040587      1         on  119028 -0.960343  0.142836   \n","4090527  f9fc61ce85  040587      1         on  119029 -0.957958  0.145494   \n","4090528  f9fc61ce85  040587      1         on  119030 -0.960616  0.145839   \n","4090529  f9fc61ce85  040587      1         on  119031 -0.967076  0.144342   \n","\n","            AccAP  StartHesitation  Turn  Walking  \n","0       -0.265625                0     0        0  \n","1       -0.265625                0     0        0  \n","2       -0.265625                0     0        0  \n","3       -0.265625                0     0        0  \n","4       -0.265625                0     0        0  \n","...           ...              ...   ...      ...  \n","4090525 -0.289655                0     0        0  \n","4090526 -0.290506                0     0        0  \n","4090527 -0.290007                0     0        0  \n","4090528 -0.291527                0     0        0  \n","4090529 -0.292384                0     0        0  \n","\n","[4090530 rows x 11 columns]"]},"execution_count":6,"metadata":{},"output_type":"execute_result"}],"source":["defog_m= defog_metadata.merge(defog, how = 'inner', left_on = 'Id', right_on = 'file')\n","defog_m.drop(['file','Valid','Task'], axis = 1, inplace = True)\n","defog_m"]},{"cell_type":"code","execution_count":7,"id":"1f46a89c","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:21.651096Z","iopub.status.busy":"2023-12-14T11:38:21.650356Z","iopub.status.idle":"2023-12-14T11:38:22.190068Z","shell.execute_reply":"2023-12-14T11:38:22.189104Z"},"papermill":{"duration":0.564316,"end_time":"2023-12-14T11:38:22.192793","exception":false,"start_time":"2023-12-14T11:38:21.628477","status":"completed"},"tags":[]},"outputs":[],"source":["# Create an empty DataFrame to store the sampled data\n","sampled_df = pd.DataFrame(columns=defog_m.columns)\n","\n","# Loop through each condition\n","for condition_column in ['StartHesitation', 'Turn', 'Walking']:\n","    # Sample 500 records for each condition\n","    condition_samples = defog_m[defog_m[condition_column] == 1].sample(n=500, random_state=42)\n","    sampled_df = pd.concat([sampled_df, condition_samples], ignore_index=True)\n","\n","# Sample 500 records for the DefaultClass condition (all three values are 0)\n","default_class_samples = defog_m[(defog_m['StartHesitation'] == 0) & (defog_m['Turn'] == 0) &\n","                                (defog_m['Walking'] == 0)].sample(n=500, random_state=42)\n","sampled_df = pd.concat([sampled_df, default_class_samples], ignore_index=True)\n","\n","# Now 'sampled_df' contains 500 records for each condition and 500 records for the DefaultClass\n","\n"]},{"cell_type":"code","execution_count":8,"id":"a490b1ee","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:22.236312Z","iopub.status.busy":"2023-12-14T11:38:22.235275Z","iopub.status.idle":"2023-12-14T11:38:22.261008Z","shell.execute_reply":"2023-12-14T11:38:22.259787Z"},"papermill":{"duration":0.050315,"end_time":"2023-12-14T11:38:22.26362","exception":false,"start_time":"2023-12-14T11:38:22.213305","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Id</th>\n","      <th>Subject</th>\n","      <th>Visit</th>\n","      <th>Medication</th>\n","      <th>Time</th>\n","      <th>AccV</th>\n","      <th>AccML</th>\n","      <th>AccAP</th>\n","      <th>StartHesitation</th>\n","      <th>Turn</th>\n","      <th>Walking</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>bf2fd0ff35</td>\n","      <td>d89567</td>\n","      <td>1</td>\n","      <td>off</td>\n","      <td>36382</td>\n","      <td>-0.796520</td>\n","      <td>0.060129</td>\n","      <td>-0.490544</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0d7ab3a9f9</td>\n","      <td>8c1f5e</td>\n","      <td>2</td>\n","      <td>on</td>\n","      <td>18223</td>\n","      <td>-0.933665</td>\n","      <td>-0.133591</td>\n","      <td>-0.400478</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>bf2fd0ff35</td>\n","      <td>d89567</td>\n","      <td>1</td>\n","      <td>off</td>\n","      <td>36395</td>\n","      <td>-0.807429</td>\n","      <td>-0.263876</td>\n","      <td>-0.497874</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>68e7e02a47</td>\n","      <td>08de77</td>\n","      <td>1</td>\n","      <td>off</td>\n","      <td>112495</td>\n","      <td>-0.902516</td>\n","      <td>-0.031580</td>\n","      <td>-0.282323</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1d99c2eecf</td>\n","      <td>12f8d1</td>\n","      <td>1</td>\n","      <td>on</td>\n","      <td>141107</td>\n","      <td>-0.923095</td>\n","      <td>0.078125</td>\n","      <td>-0.484375</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>1995</th>\n","      <td>b3891f42d0</td>\n","      <td>3e1d75</td>\n","      <td>1</td>\n","      <td>off</td>\n","      <td>42856</td>\n","      <td>-1.015625</td>\n","      <td>0.078125</td>\n","      <td>-0.031250</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1996</th>\n","      <td>a2f1a8ab76</td>\n","      <td>e86b6e</td>\n","      <td>2</td>\n","      <td>on</td>\n","      <td>34741</td>\n","      <td>-0.984986</td>\n","      <td>0.000673</td>\n","      <td>-0.059040</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1997</th>\n","      <td>4520cf1068</td>\n","      <td>3e1d75</td>\n","      <td>1</td>\n","      <td>on</td>\n","      <td>82017</td>\n","      <td>-0.968750</td>\n","      <td>0.038287</td>\n","      <td>0.055846</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1998</th>\n","      <td>02ea782681</td>\n","      <td>ae2d35</td>\n","      <td>2</td>\n","      <td>on</td>\n","      <td>30416</td>\n","      <td>-1.000000</td>\n","      <td>0.078125</td>\n","      <td>-0.218750</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1999</th>\n","      <td>68e7e02a47</td>\n","      <td>08de77</td>\n","      <td>1</td>\n","      <td>off</td>\n","      <td>53962</td>\n","      <td>-0.863281</td>\n","      <td>-0.169430</td>\n","      <td>-0.305873</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2000 rows √ó 11 columns</p>\n","</div>"],"text/plain":["              Id Subject Visit Medication    Time      AccV     AccML  \\\n","0     bf2fd0ff35  d89567     1        off   36382 -0.796520  0.060129   \n","1     0d7ab3a9f9  8c1f5e     2         on   18223 -0.933665 -0.133591   \n","2     bf2fd0ff35  d89567     1        off   36395 -0.807429 -0.263876   \n","3     68e7e02a47  08de77     1        off  112495 -0.902516 -0.031580   \n","4     1d99c2eecf  12f8d1     1         on  141107 -0.923095  0.078125   \n","...          ...     ...   ...        ...     ...       ...       ...   \n","1995  b3891f42d0  3e1d75     1        off   42856 -1.015625  0.078125   \n","1996  a2f1a8ab76  e86b6e     2         on   34741 -0.984986  0.000673   \n","1997  4520cf1068  3e1d75     1         on   82017 -0.968750  0.038287   \n","1998  02ea782681  ae2d35     2         on   30416 -1.000000  0.078125   \n","1999  68e7e02a47  08de77     1        off   53962 -0.863281 -0.169430   \n","\n","         AccAP StartHesitation Turn Walking  \n","0    -0.490544               1    0       0  \n","1    -0.400478               1    0       0  \n","2    -0.497874               1    0       0  \n","3    -0.282323               1    0       0  \n","4    -0.484375               1    0       0  \n","...        ...             ...  ...     ...  \n","1995 -0.031250               0    0       0  \n","1996 -0.059040               0    0       0  \n","1997  0.055846               0    0       0  \n","1998 -0.218750               0    0       0  \n","1999 -0.305873               0    0       0  \n","\n","[2000 rows x 11 columns]"]},"execution_count":8,"metadata":{},"output_type":"execute_result"}],"source":["sampled_df"]},{"cell_type":"code","execution_count":9,"id":"3434d03d","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:22.312518Z","iopub.status.busy":"2023-12-14T11:38:22.311152Z","iopub.status.idle":"2023-12-14T11:38:22.32159Z","shell.execute_reply":"2023-12-14T11:38:22.320422Z"},"papermill":{"duration":0.037936,"end_time":"2023-12-14T11:38:22.324593","exception":false,"start_time":"2023-12-14T11:38:22.286657","status":"completed"},"tags":[]},"outputs":[],"source":["# summary table function\n","def summary(df):\n","    print(f'data shape: {df.shape}')\n","    summ = pd.DataFrame(df.dtypes, columns=['data type'])\n","    summ['#missing'] = df.isnull().sum().values * 100\n","    summ['%missing'] = df.isnull().sum().values / len(df)\n","    summ['#unique'] = df.nunique().values\n","    desc = pd.DataFrame(df.describe(include='all').transpose())\n","    summ['min'] = desc['min'].values\n","    summ['max'] = desc['max'].values\n","    summ['first value'] = df.loc[0].values\n","    summ['second value'] = df.loc[1].values\n","    summ['third value'] = df.loc[2].values\n","    \n","    return summ"]},{"cell_type":"code","execution_count":10,"id":"f3a8d9da","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:22.37185Z","iopub.status.busy":"2023-12-14T11:38:22.371065Z","iopub.status.idle":"2023-12-14T11:38:22.440798Z","shell.execute_reply":"2023-12-14T11:38:22.439482Z"},"papermill":{"duration":0.096527,"end_time":"2023-12-14T11:38:22.443846","exception":false,"start_time":"2023-12-14T11:38:22.347319","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["data shape: (2000, 11)\n"]},{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>data type</th>\n","      <th>#missing</th>\n","      <th>%missing</th>\n","      <th>#unique</th>\n","      <th>min</th>\n","      <th>max</th>\n","      <th>first value</th>\n","      <th>second value</th>\n","      <th>third value</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>Id</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>89</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>bf2fd0ff35</td>\n","      <td>0d7ab3a9f9</td>\n","      <td>bf2fd0ff35</td>\n","    </tr>\n","    <tr>\n","      <th>Subject</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>38</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>d89567</td>\n","      <td>8c1f5e</td>\n","      <td>d89567</td>\n","    </tr>\n","    <tr>\n","      <th>Visit</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>Medication</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>off</td>\n","      <td>on</td>\n","      <td>off</td>\n","    </tr>\n","    <tr>\n","      <th>Time</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>1992</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>36382</td>\n","      <td>18223</td>\n","      <td>36395</td>\n","    </tr>\n","    <tr>\n","      <th>AccV</th>\n","      <td>float64</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>1856</td>\n","      <td>-1.552976</td>\n","      <td>-0.359375</td>\n","      <td>-0.79652</td>\n","      <td>-0.933665</td>\n","      <td>-0.807429</td>\n","    </tr>\n","    <tr>\n","      <th>AccML</th>\n","      <td>float64</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>1860</td>\n","      <td>-0.481112</td>\n","      <td>0.502826</td>\n","      <td>0.060129</td>\n","      <td>-0.133591</td>\n","      <td>-0.263876</td>\n","    </tr>\n","    <tr>\n","      <th>AccAP</th>\n","      <td>float64</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>1851</td>\n","      <td>-1.0</td>\n","      <td>0.638534</td>\n","      <td>-0.490544</td>\n","      <td>-0.400478</td>\n","      <td>-0.497874</td>\n","    </tr>\n","    <tr>\n","      <th>StartHesitation</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>Turn</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>Walking</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                data type  #missing  %missing  #unique       min       max  \\\n","Id                 object         0       0.0       89       NaN       NaN   \n","Subject            object         0       0.0       38       NaN       NaN   \n","Visit              object         0       0.0        2       NaN       NaN   \n","Medication         object         0       0.0        2       NaN       NaN   \n","Time               object         0       0.0     1992       NaN       NaN   \n","AccV              float64         0       0.0     1856 -1.552976 -0.359375   \n","AccML             float64         0       0.0     1860 -0.481112  0.502826   \n","AccAP             float64         0       0.0     1851      -1.0  0.638534   \n","StartHesitation    object         0       0.0        2       NaN       NaN   \n","Turn               object         0       0.0        2       NaN       NaN   \n","Walking            object         0       0.0        2       NaN       NaN   \n","\n","                first value second value third value  \n","Id               bf2fd0ff35   0d7ab3a9f9  bf2fd0ff35  \n","Subject              d89567       8c1f5e      d89567  \n","Visit                     1            2           1  \n","Medication              off           on         off  \n","Time                  36382        18223       36395  \n","AccV               -0.79652    -0.933665   -0.807429  \n","AccML              0.060129    -0.133591   -0.263876  \n","AccAP             -0.490544    -0.400478   -0.497874  \n","StartHesitation           1            1           1  \n","Turn                      0            0           0  \n","Walking                   0            0           0  "]},"execution_count":10,"metadata":{},"output_type":"execute_result"}],"source":["summary(sampled_df)"]},{"cell_type":"code","execution_count":11,"id":"91f31616","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:22.4919Z","iopub.status.busy":"2023-12-14T11:38:22.491034Z","iopub.status.idle":"2023-12-14T11:38:22.499751Z","shell.execute_reply":"2023-12-14T11:38:22.498706Z"},"papermill":{"duration":0.034536,"end_time":"2023-12-14T11:38:22.502139","exception":false,"start_time":"2023-12-14T11:38:22.467603","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["0    1500\n","1     500\n","Name: StartHesitation, dtype: int64"]},"execution_count":11,"metadata":{},"output_type":"execute_result"}],"source":["sampled_df['StartHesitation'].value_counts()"]},{"cell_type":"code","execution_count":12,"id":"248a7722","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:22.549872Z","iopub.status.busy":"2023-12-14T11:38:22.549184Z","iopub.status.idle":"2023-12-14T11:38:22.558183Z","shell.execute_reply":"2023-12-14T11:38:22.557057Z"},"papermill":{"duration":0.036191,"end_time":"2023-12-14T11:38:22.560813","exception":false,"start_time":"2023-12-14T11:38:22.524622","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["0    1500\n","1     500\n","Name: Turn, dtype: int64"]},"execution_count":12,"metadata":{},"output_type":"execute_result"}],"source":["sampled_df['Turn'].value_counts()"]},{"cell_type":"code","execution_count":13,"id":"696eeaea","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:22.607662Z","iopub.status.busy":"2023-12-14T11:38:22.607303Z","iopub.status.idle":"2023-12-14T11:38:22.6161Z","shell.execute_reply":"2023-12-14T11:38:22.615005Z"},"papermill":{"duration":0.034764,"end_time":"2023-12-14T11:38:22.6187","exception":false,"start_time":"2023-12-14T11:38:22.583936","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["0    1500\n","1     500\n","Name: Walking, dtype: int64"]},"execution_count":13,"metadata":{},"output_type":"execute_result"}],"source":["sampled_df['Walking'].value_counts()"]},{"cell_type":"code","execution_count":14,"id":"a01d2c6f","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:22.664326Z","iopub.status.busy":"2023-12-14T11:38:22.663975Z","iopub.status.idle":"2023-12-14T11:38:22.761486Z","shell.execute_reply":"2023-12-14T11:38:22.760514Z"},"papermill":{"duration":0.123513,"end_time":"2023-12-14T11:38:22.763898","exception":false,"start_time":"2023-12-14T11:38:22.640385","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["84"]},"execution_count":14,"metadata":{},"output_type":"execute_result"}],"source":["# garbage collection for memory\n","import gc\n","gc.collect()"]},{"cell_type":"markdown","id":"d0046796","metadata":{"papermill":{"duration":0.022962,"end_time":"2023-12-14T11:38:22.810236","exception":false,"start_time":"2023-12-14T11:38:22.787274","status":"completed"},"tags":[]},"source":["# Feature engineering and modeling (DEFOG)üè°"]},{"cell_type":"code","execution_count":15,"id":"4e11f336","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:22.860071Z","iopub.status.busy":"2023-12-14T11:38:22.859207Z","iopub.status.idle":"2023-12-14T11:38:23.710788Z","shell.execute_reply":"2023-12-14T11:38:23.709876Z"},"papermill":{"duration":0.879441,"end_time":"2023-12-14T11:38:23.713742","exception":false,"start_time":"2023-12-14T11:38:22.834301","status":"completed"},"tags":[]},"outputs":[],"source":["from sklearn.model_selection import train_test_split\n","import warnings\n","warnings.filterwarnings('ignore')"]},{"cell_type":"code","execution_count":16,"id":"0d3a74b4","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:23.760398Z","iopub.status.busy":"2023-12-14T11:38:23.759533Z","iopub.status.idle":"2023-12-14T11:38:23.768253Z","shell.execute_reply":"2023-12-14T11:38:23.767192Z"},"papermill":{"duration":0.03433,"end_time":"2023-12-14T11:38:23.771051","exception":false,"start_time":"2023-12-14T11:38:23.736721","status":"completed"},"tags":[]},"outputs":[],"source":["conditions = [\n","    (sampled_df['StartHesitation'] == 1),\n","    (sampled_df['Turn'] == 1),\n","    (sampled_df['Walking'] == 1)]\n","choices = ['StartHesitation', 'Turn', 'Walking']\n","sampled_df['event'] = np.select(conditions, choices, default='Normal')"]},{"cell_type":"code","execution_count":17,"id":"318d247f","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:23.819679Z","iopub.status.busy":"2023-12-14T11:38:23.818572Z","iopub.status.idle":"2023-12-14T11:38:23.899763Z","shell.execute_reply":"2023-12-14T11:38:23.89871Z"},"papermill":{"duration":0.10829,"end_time":"2023-12-14T11:38:23.90214","exception":false,"start_time":"2023-12-14T11:38:23.79385","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<style type=\"text/css\">\n","#T_f2562_row0_col0, #T_f2562_row1_col0, #T_f2562_row2_col0, #T_f2562_row3_col0 {\n","  background-color: #fff7fb;\n","  color: #000000;\n","}\n","</style>\n","<table id=\"T_f2562_\">\n","  <thead>\n","    <tr>\n","      <th class=\"blank level0\" >&nbsp;</th>\n","      <th class=\"col_heading level0 col0\" >event</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th id=\"T_f2562_level0_row0\" class=\"row_heading level0 row0\" >StartHesitation</th>\n","      <td id=\"T_f2562_row0_col0\" class=\"data row0 col0\" >500</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f2562_level0_row1\" class=\"row_heading level0 row1\" >Turn</th>\n","      <td id=\"T_f2562_row1_col0\" class=\"data row1 col0\" >500</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f2562_level0_row2\" class=\"row_heading level0 row2\" >Walking</th>\n","      <td id=\"T_f2562_row2_col0\" class=\"data row2 col0\" >500</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f2562_level0_row3\" class=\"row_heading level0 row3\" >Normal</th>\n","      <td id=\"T_f2562_row3_col0\" class=\"data row3 col0\" >500</td>\n","    </tr>\n","  </tbody>\n","</table>\n"],"text/plain":["<pandas.io.formats.style.Styler at 0x79bd8cc8b950>"]},"execution_count":17,"metadata":{},"output_type":"execute_result"}],"source":["sampled_df['event'].value_counts().to_frame().style.background_gradient()"]},{"cell_type":"code","execution_count":18,"id":"dabbf716","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:23.947391Z","iopub.status.busy":"2023-12-14T11:38:23.947023Z","iopub.status.idle":"2023-12-14T11:38:23.95343Z","shell.execute_reply":"2023-12-14T11:38:23.952446Z"},"papermill":{"duration":0.031339,"end_time":"2023-12-14T11:38:23.955729","exception":false,"start_time":"2023-12-14T11:38:23.92439","status":"completed"},"tags":[]},"outputs":[],"source":["train_df = sampled_df[['AccV','AccML','AccAP','event']]"]},{"cell_type":"code","execution_count":19,"id":"e6778396","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:24.000326Z","iopub.status.busy":"2023-12-14T11:38:23.99955Z","iopub.status.idle":"2023-12-14T11:38:24.006126Z","shell.execute_reply":"2023-12-14T11:38:24.005165Z"},"papermill":{"duration":0.03125,"end_time":"2023-12-14T11:38:24.008554","exception":false,"start_time":"2023-12-14T11:38:23.977304","status":"completed"},"tags":[]},"outputs":[],"source":["from sklearn.preprocessing import LabelEncoder\n","le = LabelEncoder()\n","\n","train_df['target'] = le.fit_transform(train_df['event'])"]},{"cell_type":"code","execution_count":20,"id":"a8f1d8d5","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:24.052328Z","iopub.status.busy":"2023-12-14T11:38:24.051999Z","iopub.status.idle":"2023-12-14T11:38:24.058504Z","shell.execute_reply":"2023-12-14T11:38:24.057442Z"},"papermill":{"duration":0.031042,"end_time":"2023-12-14T11:38:24.060713","exception":false,"start_time":"2023-12-14T11:38:24.029671","status":"completed"},"tags":[]},"outputs":[],"source":["X = train_df.drop(['event','target'], axis=1)\n","y = train_df['target']"]},{"cell_type":"code","execution_count":21,"id":"334f14a8","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:24.106211Z","iopub.status.busy":"2023-12-14T11:38:24.105379Z","iopub.status.idle":"2023-12-14T11:38:24.120003Z","shell.execute_reply":"2023-12-14T11:38:24.119001Z"},"papermill":{"duration":0.03984,"end_time":"2023-12-14T11:38:24.122173","exception":false,"start_time":"2023-12-14T11:38:24.082333","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>AccV</th>\n","      <th>AccML</th>\n","      <th>AccAP</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>-0.796520</td>\n","      <td>0.060129</td>\n","      <td>-0.490544</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>-0.933665</td>\n","      <td>-0.133591</td>\n","      <td>-0.400478</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>-0.807429</td>\n","      <td>-0.263876</td>\n","      <td>-0.497874</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>-0.902516</td>\n","      <td>-0.031580</td>\n","      <td>-0.282323</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>-0.923095</td>\n","      <td>0.078125</td>\n","      <td>-0.484375</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>1995</th>\n","      <td>-1.015625</td>\n","      <td>0.078125</td>\n","      <td>-0.031250</td>\n","    </tr>\n","    <tr>\n","      <th>1996</th>\n","      <td>-0.984986</td>\n","      <td>0.000673</td>\n","      <td>-0.059040</td>\n","    </tr>\n","    <tr>\n","      <th>1997</th>\n","      <td>-0.968750</td>\n","      <td>0.038287</td>\n","      <td>0.055846</td>\n","    </tr>\n","    <tr>\n","      <th>1998</th>\n","      <td>-1.000000</td>\n","      <td>0.078125</td>\n","      <td>-0.218750</td>\n","    </tr>\n","    <tr>\n","      <th>1999</th>\n","      <td>-0.863281</td>\n","      <td>-0.169430</td>\n","      <td>-0.305873</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2000 rows √ó 3 columns</p>\n","</div>"],"text/plain":["          AccV     AccML     AccAP\n","0    -0.796520  0.060129 -0.490544\n","1    -0.933665 -0.133591 -0.400478\n","2    -0.807429 -0.263876 -0.497874\n","3    -0.902516 -0.031580 -0.282323\n","4    -0.923095  0.078125 -0.484375\n","...        ...       ...       ...\n","1995 -1.015625  0.078125 -0.031250\n","1996 -0.984986  0.000673 -0.059040\n","1997 -0.968750  0.038287  0.055846\n","1998 -1.000000  0.078125 -0.218750\n","1999 -0.863281 -0.169430 -0.305873\n","\n","[2000 rows x 3 columns]"]},"execution_count":21,"metadata":{},"output_type":"execute_result"}],"source":["X"]},{"cell_type":"code","execution_count":22,"id":"9ebdb69b","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:24.16613Z","iopub.status.busy":"2023-12-14T11:38:24.165544Z","iopub.status.idle":"2023-12-14T11:38:24.173392Z","shell.execute_reply":"2023-12-14T11:38:24.172388Z"},"papermill":{"duration":0.031824,"end_time":"2023-12-14T11:38:24.175727","exception":false,"start_time":"2023-12-14T11:38:24.143903","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["0       1\n","1       1\n","2       1\n","3       1\n","4       1\n","       ..\n","1995    0\n","1996    0\n","1997    0\n","1998    0\n","1999    0\n","Name: target, Length: 2000, dtype: int64"]},"execution_count":22,"metadata":{},"output_type":"execute_result"}],"source":["y"]},{"cell_type":"code","execution_count":23,"id":"ab1bff58","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:24.21943Z","iopub.status.busy":"2023-12-14T11:38:24.219083Z","iopub.status.idle":"2023-12-14T11:38:24.226407Z","shell.execute_reply":"2023-12-14T11:38:24.225371Z"},"papermill":{"duration":0.031815,"end_time":"2023-12-14T11:38:24.228972","exception":false,"start_time":"2023-12-14T11:38:24.197157","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["array([1, 2, 3, 0])"]},"execution_count":23,"metadata":{},"output_type":"execute_result"}],"source":["y.unique()"]},{"cell_type":"code","execution_count":24,"id":"50ecf17c","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:24.276353Z","iopub.status.busy":"2023-12-14T11:38:24.275976Z","iopub.status.idle":"2023-12-14T11:38:24.284694Z","shell.execute_reply":"2023-12-14T11:38:24.28371Z"},"papermill":{"duration":0.035619,"end_time":"2023-12-14T11:38:24.28724","exception":false,"start_time":"2023-12-14T11:38:24.251621","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["1    500\n","2    500\n","3    500\n","0    500\n","Name: target, dtype: int64"]},"execution_count":24,"metadata":{},"output_type":"execute_result"}],"source":["y.value_counts()"]},{"cell_type":"code","execution_count":25,"id":"907260d3","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:24.337505Z","iopub.status.busy":"2023-12-14T11:38:24.336694Z","iopub.status.idle":"2023-12-14T11:38:24.343652Z","shell.execute_reply":"2023-12-14T11:38:24.342573Z"},"papermill":{"duration":0.034752,"end_time":"2023-12-14T11:38:24.346177","exception":false,"start_time":"2023-12-14T11:38:24.311425","status":"completed"},"tags":[]},"outputs":[],"source":["# spliting dataset into training and test set\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=1004)"]},{"cell_type":"code","execution_count":26,"id":"aefe585a","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:24.394714Z","iopub.status.busy":"2023-12-14T11:38:24.394327Z","iopub.status.idle":"2023-12-14T11:38:25.080194Z","shell.execute_reply":"2023-12-14T11:38:25.078999Z"},"papermill":{"duration":0.713116,"end_time":"2023-12-14T11:38:25.082824","exception":false,"start_time":"2023-12-14T11:38:24.369708","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["RandomForestClassifier(random_state=42)"]},"execution_count":26,"metadata":{},"output_type":"execute_result"}],"source":["# Random Forest\n","from sklearn.ensemble import RandomForestClassifier\n","\n","# Initialize the Random Forest classifier\n","rf_classifier = RandomForestClassifier(n_estimators=100, random_state=42)\n","\n","# Train the classifier\n","rf_classifier.fit(X_train, y_train)\n"]},{"cell_type":"code","execution_count":27,"id":"a345f12e","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:25.129609Z","iopub.status.busy":"2023-12-14T11:38:25.129207Z","iopub.status.idle":"2023-12-14T11:38:25.134782Z","shell.execute_reply":"2023-12-14T11:38:25.133539Z"},"papermill":{"duration":0.032237,"end_time":"2023-12-14T11:38:25.137313","exception":false,"start_time":"2023-12-14T11:38:25.105076","status":"completed"},"tags":[]},"outputs":[],"source":["from sklearn.metrics import accuracy_score, confusion_matrix, classification_report  # Import the accuracy_score function"]},{"cell_type":"code","execution_count":28,"id":"6fc1a715","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:25.185199Z","iopub.status.busy":"2023-12-14T11:38:25.184473Z","iopub.status.idle":"2023-12-14T11:38:25.221045Z","shell.execute_reply":"2023-12-14T11:38:25.220181Z"},"papermill":{"duration":0.063209,"end_time":"2023-12-14T11:38:25.223401","exception":false,"start_time":"2023-12-14T11:38:25.160192","status":"completed"},"tags":[]},"outputs":[],"source":["y_pred = rf_classifier.predict(X_test)"]},{"cell_type":"code","execution_count":29,"id":"a1ab688e","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:25.27043Z","iopub.status.busy":"2023-12-14T11:38:25.269652Z","iopub.status.idle":"2023-12-14T11:38:25.275803Z","shell.execute_reply":"2023-12-14T11:38:25.274784Z"},"papermill":{"duration":0.032063,"end_time":"2023-12-14T11:38:25.278016","exception":false,"start_time":"2023-12-14T11:38:25.245953","status":"completed"},"tags":[]},"outputs":[],"source":["def evaluate_metrics(y_true, y_pred):\n","    \n","    # Calculate metrics\n","    accuracy = accuracy_score(y_true, y_pred)\n","    conf_matrix = confusion_matrix(y_true, y_pred)\n","    classification_rep = classification_report(y_true, y_pred)\n","\n","    # Print the metrics\n","    print(f'Accuracy: {accuracy}')\n","    print(f'Confusion Matrix:\\n{conf_matrix}')\n","    print(f'Classification Report:\\n{classification_rep}')\n"]},{"cell_type":"code","execution_count":30,"id":"be86fd38","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:25.324791Z","iopub.status.busy":"2023-12-14T11:38:25.324415Z","iopub.status.idle":"2023-12-14T11:38:25.339589Z","shell.execute_reply":"2023-12-14T11:38:25.338234Z"},"papermill":{"duration":0.041875,"end_time":"2023-12-14T11:38:25.342045","exception":false,"start_time":"2023-12-14T11:38:25.30017","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy: 0.5733333333333334\n","Confusion Matrix:\n","[[ 59  17  40  35]\n"," [  6 119  12   9]\n"," [ 22  21  83  20]\n"," [ 34  20  20  83]]\n","Classification Report:\n","              precision    recall  f1-score   support\n","\n","           0       0.49      0.39      0.43       151\n","           1       0.67      0.82      0.74       146\n","           2       0.54      0.57      0.55       146\n","           3       0.56      0.53      0.55       157\n","\n","    accuracy                           0.57       600\n","   macro avg       0.57      0.58      0.57       600\n","weighted avg       0.56      0.57      0.57       600\n","\n"]}],"source":["evaluate_metrics(y_test, y_pred)"]},{"cell_type":"code","execution_count":31,"id":"86f6cb69","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:25.390231Z","iopub.status.busy":"2023-12-14T11:38:25.389834Z","iopub.status.idle":"2023-12-14T11:38:25.397775Z","shell.execute_reply":"2023-12-14T11:38:25.396703Z"},"papermill":{"duration":0.036169,"end_time":"2023-12-14T11:38:25.400988","exception":false,"start_time":"2023-12-14T11:38:25.364819","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["[2 1 1 1 1 2 3 2 1 1 2 3 0 0 1 2 2 1 2 2 3 0 0 2 1 0 2 1 1 2 1 0 1 1 0 1 2\n"," 2 0 3 2 0 0 2 3 0 3 1 3 1 2 2 0 1 3 2 3 1 1 2 2 1 2 1 2 3 1 3 1 1 2 3 2 0\n"," 2 1 3 0 0 0 0 1 3 3 1 1 0 0 1 0 2 3 1 1 1 1 3 2 2 2 0 2 3 0 1 3 0 3 2 0 2\n"," 2 2 1 0 0 3 3 2 3 1 3 2 0 1 2 0 0 3 2 0 2 2 3 0 0 1 2 3 3 0 0 1 2 1 1 3 0\n"," 0 1 2 0 0 3 0 1 1 1 2 0 2 3 1 1 1 2 0 3 2 3 1 3 3 2 1 2 1 0 1 1 3 1 1 2 3\n"," 3 2 1 0 2 0 2 2 1 0 1 2 0 0 3 1 1 2 0 0 2 1 1 1 1 3 0 2 3 3 3 1 2 3 3 0 3\n"," 2 2 2 3 2 3 2 1 3 3 0 1 2 2 2 2 3 3 3 3 3 2 2 1 3 1 2 3 1 1 3 2 2 3 1 1 2\n"," 3 0 0 0 3 0 2 1 3 2 3 1 2 3 3 3 1 0 1 2 0 2 2 2 3 2 0 3 0 2 1 3 3 3 2 1 2\n"," 2 2 3 0 1 1 0 2 3 3 2 3 1 2 1 0 1 0 2 2 0 0 0 1 1 1 1 3 0 3 2 2 0 1 3 0 1\n"," 3 0 1 0 2 0 2 2 2 2 0 1 1 0 1 3 0 1 0 3 1 3 1 1 0 2 2 3 2 0 3 3 0 0 3 1 3\n"," 2 1 1 3 3 3 2 3 3 2 1 0 3 3 3 1 0 2 2 0 1 1 3 0 2 1 2 0 1 1 1 1 0 2 1 2 1\n"," 2 2 1 2 3 1 2 2 1 3 1 1 3 1 2 2 2 3 1 1 2 1 1 1 1 1 1 0 2 0 3 1 1 2 3 3 1\n"," 1 0 3 3 0 2 3 0 3 3 3 1 0 3 2 2 2 2 0 0 3 2 0 0 3 1 0 3 2 0 2 1 1 2 1 1 1\n"," 0 3 1 2 0 1 1 2 2 3 1 3 2 0 2 2 1 1 3 1 0 3 1 1 1 1 3 2 3 1 3 2 0 1 3 1 2\n"," 3 1 3 1 1 0 3 1 0 0 0 3 3 1 1 1 0 3 3 1 2 3 3 0 3 3 3 2 0 0 3 3 1 2 2 1 1\n"," 1 2 0 1 1 0 2 2 3 0 0 3 2 2 0 3 0 3 0 3 1 1 1 1 2 1 2 1 3 1 3 2 1 3 2 1 0\n"," 1 3 2 0 2 1 3 3]\n"]}],"source":["print(y_pred[0:999])"]},{"cell_type":"code","execution_count":32,"id":"0654ebb9","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:25.450135Z","iopub.status.busy":"2023-12-14T11:38:25.449795Z","iopub.status.idle":"2023-12-14T11:38:26.296949Z","shell.execute_reply":"2023-12-14T11:38:26.295675Z"},"papermill":{"duration":0.875211,"end_time":"2023-12-14T11:38:26.300029","exception":false,"start_time":"2023-12-14T11:38:25.424818","status":"completed"},"tags":[]},"outputs":[],"source":["test_defog_path = '/kaggle/input/tlvmc-parkinsons-freezing-gait-prediction/test/defog/02ab235146.csv'\n","test_defog = pd.read_csv(test_defog_path)\n","name = os.path.basename(test_defog_path)\n","id_value = name.split('.')[0]\n","test_defog['Id_value'] = id_value\n","test_defog['Id'] = test_defog['Id_value'].astype(str) + '_' + test_defog['Time'].astype(str)\n","test_defog = test_defog[['Id','AccV','AccML','AccAP']]\n","test_defog.set_index('Id',inplace=True)"]},{"cell_type":"code","execution_count":33,"id":"921ec536","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:26.348987Z","iopub.status.busy":"2023-12-14T11:38:26.348603Z","iopub.status.idle":"2023-12-14T11:38:28.635602Z","shell.execute_reply":"2023-12-14T11:38:28.634681Z"},"papermill":{"duration":2.314916,"end_time":"2023-12-14T11:38:28.638491","exception":false,"start_time":"2023-12-14T11:38:26.323575","status":"completed"},"tags":[]},"outputs":[],"source":["# predict event probability\n","test_defog_pred=rf_classifier.predict(test_defog)\n","test_defog['event'] = test_defog_pred"]},{"cell_type":"code","execution_count":34,"id":"703cc811","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:28.68398Z","iopub.status.busy":"2023-12-14T11:38:28.683553Z","iopub.status.idle":"2023-12-14T11:38:28.69998Z","shell.execute_reply":"2023-12-14T11:38:28.698952Z"},"papermill":{"duration":0.041384,"end_time":"2023-12-14T11:38:28.7022","exception":false,"start_time":"2023-12-14T11:38:28.660816","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>AccV</th>\n","      <th>AccML</th>\n","      <th>AccAP</th>\n","      <th>event</th>\n","    </tr>\n","    <tr>\n","      <th>Id</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>02ab235146_0</th>\n","      <td>-0.914652</td>\n","      <td>-0.300851</td>\n","      <td>0.298156</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_1</th>\n","      <td>-0.914367</td>\n","      <td>-0.301572</td>\n","      <td>0.298325</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_2</th>\n","      <td>-0.779540</td>\n","      <td>-0.343197</td>\n","      <td>0.275690</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_3</th>\n","      <td>-0.993162</td>\n","      <td>-0.270281</td>\n","      <td>0.315775</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_4</th>\n","      <td>-0.948767</td>\n","      <td>-0.307849</td>\n","      <td>0.297191</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_281683</th>\n","      <td>-0.899299</td>\n","      <td>-0.232668</td>\n","      <td>0.389147</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_281684</th>\n","      <td>-0.901973</td>\n","      <td>-0.233051</td>\n","      <td>0.390114</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_281685</th>\n","      <td>-0.901690</td>\n","      <td>-0.231888</td>\n","      <td>0.391896</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_281686</th>\n","      <td>-0.899576</td>\n","      <td>-0.232429</td>\n","      <td>0.391106</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_281687</th>\n","      <td>-0.900289</td>\n","      <td>-0.232363</td>\n","      <td>0.390735</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>281688 rows √ó 4 columns</p>\n","</div>"],"text/plain":["                       AccV     AccML     AccAP  event\n","Id                                                    \n","02ab235146_0      -0.914652 -0.300851  0.298156      0\n","02ab235146_1      -0.914367 -0.301572  0.298325      0\n","02ab235146_2      -0.779540 -0.343197  0.275690      0\n","02ab235146_3      -0.993162 -0.270281  0.315775      0\n","02ab235146_4      -0.948767 -0.307849  0.297191      0\n","...                     ...       ...       ...    ...\n","02ab235146_281683 -0.899299 -0.232668  0.389147      0\n","02ab235146_281684 -0.901973 -0.233051  0.390114      0\n","02ab235146_281685 -0.901690 -0.231888  0.391896      0\n","02ab235146_281686 -0.899576 -0.232429  0.391106      0\n","02ab235146_281687 -0.900289 -0.232363  0.390735      0\n","\n","[281688 rows x 4 columns]"]},"execution_count":34,"metadata":{},"output_type":"execute_result"}],"source":["test_defog"]},{"cell_type":"code","execution_count":35,"id":"4a137b89","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:28.748444Z","iopub.status.busy":"2023-12-14T11:38:28.74815Z","iopub.status.idle":"2023-12-14T11:38:28.759097Z","shell.execute_reply":"2023-12-14T11:38:28.75811Z"},"papermill":{"duration":0.036678,"end_time":"2023-12-14T11:38:28.761453","exception":false,"start_time":"2023-12-14T11:38:28.724775","status":"completed"},"tags":[]},"outputs":[],"source":["# expand event column it to three columns\n","test_defog['StartHesitation'] = np.where(test_defog['event']==1, 1, 0)\n","test_defog['Turn'] = np.where(test_defog['event']==2, 1, 0)\n","test_defog['Walking'] = np.where(test_defog['event']==3, 1, 0)"]},{"cell_type":"code","execution_count":36,"id":"be46dcb5","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:28.810204Z","iopub.status.busy":"2023-12-14T11:38:28.809253Z","iopub.status.idle":"2023-12-14T11:38:28.827117Z","shell.execute_reply":"2023-12-14T11:38:28.825999Z"},"papermill":{"duration":0.04535,"end_time":"2023-12-14T11:38:28.82953","exception":false,"start_time":"2023-12-14T11:38:28.78418","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>AccV</th>\n","      <th>AccML</th>\n","      <th>AccAP</th>\n","      <th>event</th>\n","      <th>StartHesitation</th>\n","      <th>Turn</th>\n","      <th>Walking</th>\n","    </tr>\n","    <tr>\n","      <th>Id</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>02ab235146_0</th>\n","      <td>-0.914652</td>\n","      <td>-0.300851</td>\n","      <td>0.298156</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_1</th>\n","      <td>-0.914367</td>\n","      <td>-0.301572</td>\n","      <td>0.298325</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_2</th>\n","      <td>-0.779540</td>\n","      <td>-0.343197</td>\n","      <td>0.275690</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_3</th>\n","      <td>-0.993162</td>\n","      <td>-0.270281</td>\n","      <td>0.315775</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_4</th>\n","      <td>-0.948767</td>\n","      <td>-0.307849</td>\n","      <td>0.297191</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_281683</th>\n","      <td>-0.899299</td>\n","      <td>-0.232668</td>\n","      <td>0.389147</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_281684</th>\n","      <td>-0.901973</td>\n","      <td>-0.233051</td>\n","      <td>0.390114</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_281685</th>\n","      <td>-0.901690</td>\n","      <td>-0.231888</td>\n","      <td>0.391896</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_281686</th>\n","      <td>-0.899576</td>\n","      <td>-0.232429</td>\n","      <td>0.391106</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>02ab235146_281687</th>\n","      <td>-0.900289</td>\n","      <td>-0.232363</td>\n","      <td>0.390735</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>281688 rows √ó 7 columns</p>\n","</div>"],"text/plain":["                       AccV     AccML     AccAP  event  StartHesitation  Turn  \\\n","Id                                                                              \n","02ab235146_0      -0.914652 -0.300851  0.298156      0                0     0   \n","02ab235146_1      -0.914367 -0.301572  0.298325      0                0     0   \n","02ab235146_2      -0.779540 -0.343197  0.275690      0                0     0   \n","02ab235146_3      -0.993162 -0.270281  0.315775      0                0     0   \n","02ab235146_4      -0.948767 -0.307849  0.297191      0                0     0   \n","...                     ...       ...       ...    ...              ...   ...   \n","02ab235146_281683 -0.899299 -0.232668  0.389147      0                0     0   \n","02ab235146_281684 -0.901973 -0.233051  0.390114      0                0     0   \n","02ab235146_281685 -0.901690 -0.231888  0.391896      0                0     0   \n","02ab235146_281686 -0.899576 -0.232429  0.391106      0                0     0   \n","02ab235146_281687 -0.900289 -0.232363  0.390735      0                0     0   \n","\n","                   Walking  \n","Id                          \n","02ab235146_0             0  \n","02ab235146_1             0  \n","02ab235146_2             0  \n","02ab235146_3             0  \n","02ab235146_4             0  \n","...                    ...  \n","02ab235146_281683        0  \n","02ab235146_281684        0  \n","02ab235146_281685        0  \n","02ab235146_281686        0  \n","02ab235146_281687        0  \n","\n","[281688 rows x 7 columns]"]},"execution_count":36,"metadata":{},"output_type":"execute_result"}],"source":["test_defog"]},{"cell_type":"code","execution_count":37,"id":"0f2c7215","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:28.877332Z","iopub.status.busy":"2023-12-14T11:38:28.876928Z","iopub.status.idle":"2023-12-14T11:38:28.896148Z","shell.execute_reply":"2023-12-14T11:38:28.895046Z"},"papermill":{"duration":0.046152,"end_time":"2023-12-14T11:38:28.898774","exception":false,"start_time":"2023-12-14T11:38:28.852622","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["0    156359\n","3     75020\n","2     39948\n","1     10361\n","Name: event, dtype: int64 \n","\n","0    271327\n","1     10361\n","Name: StartHesitation, dtype: int64 \n","\n","0    241740\n","1     39948\n","Name: Turn, dtype: int64 \n","\n","0    206668\n","1     75020\n","Name: Walking, dtype: int64 \n","\n"]}],"source":["print(test_defog['event'].value_counts(),'\\n')\n","print(test_defog['StartHesitation'].value_counts(),'\\n')\n","print(test_defog['Turn'].value_counts(),'\\n')\n","print(test_defog['Walking'].value_counts(),'\\n')"]},{"cell_type":"markdown","id":"3026616d","metadata":{"papermill":{"duration":0.023892,"end_time":"2023-12-14T11:38:28.94675","exception":false,"start_time":"2023-12-14T11:38:28.922858","status":"completed"},"tags":[]},"source":["## TDCSFOGü•º"]},{"cell_type":"code","execution_count":38,"id":"f98ed6c8","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:38:28.996696Z","iopub.status.busy":"2023-12-14T11:38:28.996205Z","iopub.status.idle":"2023-12-14T11:40:51.279864Z","shell.execute_reply":"2023-12-14T11:40:51.2787Z"},"papermill":{"duration":142.335733,"end_time":"2023-12-14T11:40:51.307078","exception":false,"start_time":"2023-12-14T11:38:28.971345","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Time</th>\n","      <th>AccV</th>\n","      <th>AccML</th>\n","      <th>AccAP</th>\n","      <th>StartHesitation</th>\n","      <th>Turn</th>\n","      <th>Walking</th>\n","      <th>file</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-9.665890</td>\n","      <td>0.042550</td>\n","      <td>0.184744</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>a171e61840</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>-9.672969</td>\n","      <td>0.049217</td>\n","      <td>0.184644</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>a171e61840</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>-9.670260</td>\n","      <td>0.033620</td>\n","      <td>0.193790</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>a171e61840</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>-9.673356</td>\n","      <td>0.035159</td>\n","      <td>0.184369</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>a171e61840</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>-9.671458</td>\n","      <td>0.043913</td>\n","      <td>0.197814</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>a171e61840</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>5153</th>\n","      <td>5153</td>\n","      <td>-9.915920</td>\n","      <td>-0.105897</td>\n","      <td>-1.123455</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0506d9a39f</td>\n","    </tr>\n","    <tr>\n","      <th>5154</th>\n","      <td>5154</td>\n","      <td>-9.693752</td>\n","      <td>-0.066892</td>\n","      <td>-1.114903</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0506d9a39f</td>\n","    </tr>\n","    <tr>\n","      <th>5155</th>\n","      <td>5155</td>\n","      <td>-9.548118</td>\n","      <td>-0.098315</td>\n","      <td>-1.112123</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0506d9a39f</td>\n","    </tr>\n","    <tr>\n","      <th>5156</th>\n","      <td>5156</td>\n","      <td>-9.469803</td>\n","      <td>-0.111004</td>\n","      <td>-1.130814</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0506d9a39f</td>\n","    </tr>\n","    <tr>\n","      <th>5157</th>\n","      <td>5157</td>\n","      <td>-9.566318</td>\n","      <td>-0.113865</td>\n","      <td>-1.103353</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0506d9a39f</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>7062672 rows √ó 8 columns</p>\n","</div>"],"text/plain":["      Time      AccV     AccML     AccAP  StartHesitation  Turn  Walking  \\\n","0        0 -9.665890  0.042550  0.184744                0     0        0   \n","1        1 -9.672969  0.049217  0.184644                0     0        0   \n","2        2 -9.670260  0.033620  0.193790                0     0        0   \n","3        3 -9.673356  0.035159  0.184369                0     0        0   \n","4        4 -9.671458  0.043913  0.197814                0     0        0   \n","...    ...       ...       ...       ...              ...   ...      ...   \n","5153  5153 -9.915920 -0.105897 -1.123455                0     0        0   \n","5154  5154 -9.693752 -0.066892 -1.114903                0     0        0   \n","5155  5155 -9.548118 -0.098315 -1.112123                0     0        0   \n","5156  5156 -9.469803 -0.111004 -1.130814                0     0        0   \n","5157  5157 -9.566318 -0.113865 -1.103353                0     0        0   \n","\n","            file  \n","0     a171e61840  \n","1     a171e61840  \n","2     a171e61840  \n","3     a171e61840  \n","4     a171e61840  \n","...          ...  \n","5153  0506d9a39f  \n","5154  0506d9a39f  \n","5155  0506d9a39f  \n","5156  0506d9a39f  \n","5157  0506d9a39f  \n","\n","[7062672 rows x 8 columns]"]},"execution_count":38,"metadata":{},"output_type":"execute_result"}],"source":["DATA_ROOT_TDCSFOG = '/kaggle/input/tlvmc-parkinsons-freezing-gait-prediction/train/tdcsfog/'\n","tdcsfog = pd.DataFrame()\n","for root, dirs, files in os.walk(DATA_ROOT_TDCSFOG):\n","    for name in files:       \n","        f = os.path.join(root, name)\n","        df_list= pd.read_csv(f)\n","        words = name.split('.')[0]\n","        df_list['file']= name.split('.')[0]\n","        tdcsfog = pd.concat([tdcsfog, df_list], axis=0)\n","tdcsfog"]},{"cell_type":"markdown","id":"186ae5f8","metadata":{"papermill":{"duration":0.025073,"end_time":"2023-12-14T11:40:51.355945","exception":false,"start_time":"2023-12-14T11:40:51.330872","status":"completed"},"tags":[]},"source":["##  Combining it with ü•ºtdcsfog-metadata."]},{"cell_type":"code","execution_count":39,"id":"fcf2587a","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:40:51.406026Z","iopub.status.busy":"2023-12-14T11:40:51.405086Z","iopub.status.idle":"2023-12-14T11:40:51.429599Z","shell.execute_reply":"2023-12-14T11:40:51.428509Z"},"papermill":{"duration":0.051786,"end_time":"2023-12-14T11:40:51.431941","exception":false,"start_time":"2023-12-14T11:40:51.380155","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Id</th>\n","      <th>Subject</th>\n","      <th>Visit</th>\n","      <th>Test</th>\n","      <th>Medication</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>003f117e14</td>\n","      <td>4dc2f8</td>\n","      <td>3</td>\n","      <td>2</td>\n","      <td>on</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>009ee11563</td>\n","      <td>f62eec</td>\n","      <td>4</td>\n","      <td>2</td>\n","      <td>on</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>011322847a</td>\n","      <td>231c3b</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>on</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>01d0fe7266</td>\n","      <td>231c3b</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>off</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>024418ba39</td>\n","      <td>fa8764</td>\n","      <td>19</td>\n","      <td>3</td>\n","      <td>on</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>828</th>\n","      <td>feba449e1a</td>\n","      <td>312788</td>\n","      <td>19</td>\n","      <td>1</td>\n","      <td>on</td>\n","    </tr>\n","    <tr>\n","      <th>829</th>\n","      <td>ff4f844fd3</td>\n","      <td>af82b2</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>on</td>\n","    </tr>\n","    <tr>\n","      <th>830</th>\n","      <td>ff53514514</td>\n","      <td>3b2403</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>on</td>\n","    </tr>\n","    <tr>\n","      <th>831</th>\n","      <td>ff92d9244d</td>\n","      <td>2d57c2</td>\n","      <td>20</td>\n","      <td>2</td>\n","      <td>on</td>\n","    </tr>\n","    <tr>\n","      <th>832</th>\n","      <td>ffda8fadfd</td>\n","      <td>7fcee9</td>\n","      <td>20</td>\n","      <td>1</td>\n","      <td>off</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>833 rows √ó 5 columns</p>\n","</div>"],"text/plain":["             Id Subject  Visit  Test Medication\n","0    003f117e14  4dc2f8      3     2         on\n","1    009ee11563  f62eec      4     2         on\n","2    011322847a  231c3b      2     2         on\n","3    01d0fe7266  231c3b      2     1        off\n","4    024418ba39  fa8764     19     3         on\n","..          ...     ...    ...   ...        ...\n","828  feba449e1a  312788     19     1         on\n","829  ff4f844fd3  af82b2      2     3         on\n","830  ff53514514  3b2403      2     3         on\n","831  ff92d9244d  2d57c2     20     2         on\n","832  ffda8fadfd  7fcee9     20     1        off\n","\n","[833 rows x 5 columns]"]},"execution_count":39,"metadata":{},"output_type":"execute_result"}],"source":["tdcsfog_metadata = pd.read_csv(\"/kaggle/input/tlvmc-parkinsons-freezing-gait-prediction/tdcsfog_metadata.csv\")\n","tdcsfog_metadata"]},{"cell_type":"code","execution_count":40,"id":"0217fdde","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:40:51.481077Z","iopub.status.busy":"2023-12-14T11:40:51.48041Z","iopub.status.idle":"2023-12-14T11:40:55.809026Z","shell.execute_reply":"2023-12-14T11:40:55.807669Z"},"papermill":{"duration":4.356551,"end_time":"2023-12-14T11:40:55.812296","exception":false,"start_time":"2023-12-14T11:40:51.455745","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Id</th>\n","      <th>Subject</th>\n","      <th>Visit</th>\n","      <th>Test</th>\n","      <th>Medication</th>\n","      <th>Time</th>\n","      <th>AccV</th>\n","      <th>AccML</th>\n","      <th>AccAP</th>\n","      <th>StartHesitation</th>\n","      <th>Turn</th>\n","      <th>Walking</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>003f117e14</td>\n","      <td>4dc2f8</td>\n","      <td>3</td>\n","      <td>2</td>\n","      <td>on</td>\n","      <td>0</td>\n","      <td>-9.533939</td>\n","      <td>0.566322</td>\n","      <td>-1.413525</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>003f117e14</td>\n","      <td>4dc2f8</td>\n","      <td>3</td>\n","      <td>2</td>\n","      <td>on</td>\n","      <td>1</td>\n","      <td>-9.536140</td>\n","      <td>0.564137</td>\n","      <td>-1.440621</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>003f117e14</td>\n","      <td>4dc2f8</td>\n","      <td>3</td>\n","      <td>2</td>\n","      <td>on</td>\n","      <td>2</td>\n","      <td>-9.529345</td>\n","      <td>0.561765</td>\n","      <td>-1.429332</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>003f117e14</td>\n","      <td>4dc2f8</td>\n","      <td>3</td>\n","      <td>2</td>\n","      <td>on</td>\n","      <td>3</td>\n","      <td>-9.531239</td>\n","      <td>0.564227</td>\n","      <td>-1.415490</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>003f117e14</td>\n","      <td>4dc2f8</td>\n","      <td>3</td>\n","      <td>2</td>\n","      <td>on</td>\n","      <td>4</td>\n","      <td>-9.540825</td>\n","      <td>0.561854</td>\n","      <td>-1.429471</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>7062667</th>\n","      <td>ffda8fadfd</td>\n","      <td>7fcee9</td>\n","      <td>20</td>\n","      <td>1</td>\n","      <td>off</td>\n","      <td>4220</td>\n","      <td>-9.403467</td>\n","      <td>0.089003</td>\n","      <td>-3.220304</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>7062668</th>\n","      <td>ffda8fadfd</td>\n","      <td>7fcee9</td>\n","      <td>20</td>\n","      <td>1</td>\n","      <td>off</td>\n","      <td>4221</td>\n","      <td>-9.404246</td>\n","      <td>0.090531</td>\n","      <td>-3.216584</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>7062669</th>\n","      <td>ffda8fadfd</td>\n","      <td>7fcee9</td>\n","      <td>20</td>\n","      <td>1</td>\n","      <td>off</td>\n","      <td>4222</td>\n","      <td>-9.405770</td>\n","      <td>0.084380</td>\n","      <td>-3.224039</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>7062670</th>\n","      <td>ffda8fadfd</td>\n","      <td>7fcee9</td>\n","      <td>20</td>\n","      <td>1</td>\n","      <td>off</td>\n","      <td>4223</td>\n","      <td>-9.403579</td>\n","      <td>0.084236</td>\n","      <td>-3.236686</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>7062671</th>\n","      <td>ffda8fadfd</td>\n","      <td>7fcee9</td>\n","      <td>20</td>\n","      <td>1</td>\n","      <td>off</td>\n","      <td>4224</td>\n","      <td>-9.405036</td>\n","      <td>0.082027</td>\n","      <td>-3.234458</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>7062672 rows √ó 12 columns</p>\n","</div>"],"text/plain":["                 Id Subject  Visit  Test Medication  Time      AccV     AccML  \\\n","0        003f117e14  4dc2f8      3     2         on     0 -9.533939  0.566322   \n","1        003f117e14  4dc2f8      3     2         on     1 -9.536140  0.564137   \n","2        003f117e14  4dc2f8      3     2         on     2 -9.529345  0.561765   \n","3        003f117e14  4dc2f8      3     2         on     3 -9.531239  0.564227   \n","4        003f117e14  4dc2f8      3     2         on     4 -9.540825  0.561854   \n","...             ...     ...    ...   ...        ...   ...       ...       ...   \n","7062667  ffda8fadfd  7fcee9     20     1        off  4220 -9.403467  0.089003   \n","7062668  ffda8fadfd  7fcee9     20     1        off  4221 -9.404246  0.090531   \n","7062669  ffda8fadfd  7fcee9     20     1        off  4222 -9.405770  0.084380   \n","7062670  ffda8fadfd  7fcee9     20     1        off  4223 -9.403579  0.084236   \n","7062671  ffda8fadfd  7fcee9     20     1        off  4224 -9.405036  0.082027   \n","\n","            AccAP  StartHesitation  Turn  Walking  \n","0       -1.413525                0     0        0  \n","1       -1.440621                0     0        0  \n","2       -1.429332                0     0        0  \n","3       -1.415490                0     0        0  \n","4       -1.429471                0     0        0  \n","...           ...              ...   ...      ...  \n","7062667 -3.220304                0     0        0  \n","7062668 -3.216584                0     0        0  \n","7062669 -3.224039                0     0        0  \n","7062670 -3.236686                0     0        0  \n","7062671 -3.234458                0     0        0  \n","\n","[7062672 rows x 12 columns]"]},"execution_count":40,"metadata":{},"output_type":"execute_result"}],"source":["tdcsfog_m= tdcsfog_metadata.merge(tdcsfog, how = 'inner', left_on = 'Id', right_on = 'file')\n","tdcsfog_m.drop(['file'], axis = 1, inplace = True)\n","tdcsfog_m"]},{"cell_type":"markdown","id":"ede0c75a","metadata":{"papermill":{"duration":0.027579,"end_time":"2023-12-14T11:40:55.872876","exception":false,"start_time":"2023-12-14T11:40:55.845297","status":"completed"},"tags":[]},"source":["# Feature engineering and modeling (tdcsDEFOG)ü•º"]},{"cell_type":"code","execution_count":41,"id":"cc571a4e","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:40:55.927674Z","iopub.status.busy":"2023-12-14T11:40:55.926878Z","iopub.status.idle":"2023-12-14T11:40:57.492819Z","shell.execute_reply":"2023-12-14T11:40:57.491883Z"},"papermill":{"duration":1.595817,"end_time":"2023-12-14T11:40:57.495488","exception":false,"start_time":"2023-12-14T11:40:55.899671","status":"completed"},"tags":[]},"outputs":[],"source":["# Create an empty DataFrame to store the sampled data\n","tdcs_sampled_df = pd.DataFrame(columns=defog_m.columns)\n","\n","# Loop through each condition\n","for condition_column in ['StartHesitation', 'Turn', 'Walking']:\n","    # Sample 500 records for each condition\n","    condition_samples = tdcsfog_m[tdcsfog_m[condition_column] == 1].sample(n=207838, random_state=42)\n","    tdcs_sampled_df = pd.concat([tdcs_sampled_df, condition_samples], ignore_index=True)\n","\n","# Sample 500 records for the DefaultClass condition (all three values are 0)\n","default_class_samples = tdcsfog_m[(tdcsfog_m['StartHesitation'] == 0) & (tdcsfog_m['Turn'] == 0) &\n","                                (tdcsfog_m['Walking'] == 0)].sample(n=207838, random_state=42)\n","tdcs_sampled_df = pd.concat([tdcs_sampled_df, default_class_samples], ignore_index=True)\n","\n","# Now 'sampled_df' contains 500 records for each condition and 500 records for the DefaultClass\n","\n"]},{"cell_type":"code","execution_count":42,"id":"30c9be1b","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:40:57.546119Z","iopub.status.busy":"2023-12-14T11:40:57.545476Z","iopub.status.idle":"2023-12-14T11:41:01.668882Z","shell.execute_reply":"2023-12-14T11:41:01.667731Z"},"papermill":{"duration":4.151561,"end_time":"2023-12-14T11:41:01.671538","exception":false,"start_time":"2023-12-14T11:40:57.519977","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["data shape: (831352, 12)\n"]},{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>data type</th>\n","      <th>#missing</th>\n","      <th>%missing</th>\n","      <th>#unique</th>\n","      <th>min</th>\n","      <th>max</th>\n","      <th>first value</th>\n","      <th>second value</th>\n","      <th>third value</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>Id</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>833</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>e318182fe2</td>\n","      <td>2d4c5f6c17</td>\n","      <td>be8fdfa712</td>\n","    </tr>\n","    <tr>\n","      <th>Subject</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>62</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>79011a</td>\n","      <td>b19f77</td>\n","      <td>194d1d</td>\n","    </tr>\n","    <tr>\n","      <th>Visit</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>7</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>3</td>\n","      <td>2</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>Medication</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>on</td>\n","      <td>on</td>\n","      <td>off</td>\n","    </tr>\n","    <tr>\n","      <th>Time</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>88318</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>575</td>\n","      <td>2095</td>\n","      <td>49407</td>\n","    </tr>\n","    <tr>\n","      <th>AccV</th>\n","      <td>float64</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>826336</td>\n","      <td>-26.477008</td>\n","      <td>5.797328</td>\n","      <td>-9.860968</td>\n","      <td>-9.896153</td>\n","      <td>-10.027954</td>\n","    </tr>\n","    <tr>\n","      <th>AccML</th>\n","      <td>float64</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>827434</td>\n","      <td>-23.241254</td>\n","      <td>24.540494</td>\n","      <td>0.71676</td>\n","      <td>0.550487</td>\n","      <td>-0.902985</td>\n","    </tr>\n","    <tr>\n","      <th>AccAP</th>\n","      <td>float64</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>826852</td>\n","      <td>-30.231809</td>\n","      <td>29.341835</td>\n","      <td>1.636743</td>\n","      <td>1.023587</td>\n","      <td>0.703142</td>\n","    </tr>\n","    <tr>\n","      <th>StartHesitation</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>Turn</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>Walking</th>\n","      <td>object</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>Test</th>\n","      <td>float64</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>3</td>\n","      <td>1.0</td>\n","      <td>3.0</td>\n","      <td>3.0</td>\n","      <td>1.0</td>\n","      <td>2.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                data type  #missing  %missing  #unique        min        max  \\\n","Id                 object         0       0.0      833        NaN        NaN   \n","Subject            object         0       0.0       62        NaN        NaN   \n","Visit              object         0       0.0        7        NaN        NaN   \n","Medication         object         0       0.0        2        NaN        NaN   \n","Time               object         0       0.0    88318        NaN        NaN   \n","AccV              float64         0       0.0   826336 -26.477008   5.797328   \n","AccML             float64         0       0.0   827434 -23.241254  24.540494   \n","AccAP             float64         0       0.0   826852 -30.231809  29.341835   \n","StartHesitation    object         0       0.0        2        NaN        NaN   \n","Turn               object         0       0.0        2        NaN        NaN   \n","Walking            object         0       0.0        2        NaN        NaN   \n","Test              float64         0       0.0        3        1.0        3.0   \n","\n","                first value second value third value  \n","Id               e318182fe2   2d4c5f6c17  be8fdfa712  \n","Subject              79011a       b19f77      194d1d  \n","Visit                     3            2           2  \n","Medication               on           on         off  \n","Time                    575         2095       49407  \n","AccV              -9.860968    -9.896153  -10.027954  \n","AccML               0.71676     0.550487   -0.902985  \n","AccAP              1.636743     1.023587    0.703142  \n","StartHesitation           1            1           1  \n","Turn                      0            0           0  \n","Walking                   0            0           0  \n","Test                    3.0          1.0         2.0  "]},"execution_count":42,"metadata":{},"output_type":"execute_result"}],"source":["summary(tdcs_sampled_df)"]},{"cell_type":"code","execution_count":43,"id":"6ace30c9","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:01.725994Z","iopub.status.busy":"2023-12-14T11:41:01.725062Z","iopub.status.idle":"2023-12-14T11:41:01.840206Z","shell.execute_reply":"2023-12-14T11:41:01.839037Z"},"papermill":{"duration":0.145587,"end_time":"2023-12-14T11:41:01.842687","exception":false,"start_time":"2023-12-14T11:41:01.6971","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["69"]},"execution_count":43,"metadata":{},"output_type":"execute_result"}],"source":["# garbage collection for memory\n","import gc\n","gc.collect()"]},{"cell_type":"code","execution_count":44,"id":"f734e772","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:01.893085Z","iopub.status.busy":"2023-12-14T11:41:01.892306Z","iopub.status.idle":"2023-12-14T11:41:02.40115Z","shell.execute_reply":"2023-12-14T11:41:02.400166Z"},"papermill":{"duration":0.536861,"end_time":"2023-12-14T11:41:02.403969","exception":false,"start_time":"2023-12-14T11:41:01.867108","status":"completed"},"tags":[]},"outputs":[],"source":["conditions = [\n","    (tdcs_sampled_df['StartHesitation'] == 1),\n","    (tdcs_sampled_df['Turn'] == 1),\n","    (tdcs_sampled_df['Walking'] == 1)]\n","choices = ['StartHesitation', 'Turn', 'Walking']\n","tdcs_sampled_df['event'] = np.select(conditions, choices, default='Normal')"]},{"cell_type":"code","execution_count":45,"id":"63f3ced5","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:02.455864Z","iopub.status.busy":"2023-12-14T11:41:02.455226Z","iopub.status.idle":"2023-12-14T11:41:02.614983Z","shell.execute_reply":"2023-12-14T11:41:02.613681Z"},"papermill":{"duration":0.187739,"end_time":"2023-12-14T11:41:02.617482","exception":false,"start_time":"2023-12-14T11:41:02.429743","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<style type=\"text/css\">\n","#T_0d2fb_row0_col0, #T_0d2fb_row1_col0, #T_0d2fb_row2_col0, #T_0d2fb_row3_col0 {\n","  background-color: #fff7fb;\n","  color: #000000;\n","}\n","</style>\n","<table id=\"T_0d2fb_\">\n","  <thead>\n","    <tr>\n","      <th class=\"blank level0\" >&nbsp;</th>\n","      <th class=\"col_heading level0 col0\" >event</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th id=\"T_0d2fb_level0_row0\" class=\"row_heading level0 row0\" >StartHesitation</th>\n","      <td id=\"T_0d2fb_row0_col0\" class=\"data row0 col0\" >207838</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_0d2fb_level0_row1\" class=\"row_heading level0 row1\" >Turn</th>\n","      <td id=\"T_0d2fb_row1_col0\" class=\"data row1 col0\" >207838</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_0d2fb_level0_row2\" class=\"row_heading level0 row2\" >Walking</th>\n","      <td id=\"T_0d2fb_row2_col0\" class=\"data row2 col0\" >207838</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_0d2fb_level0_row3\" class=\"row_heading level0 row3\" >Normal</th>\n","      <td id=\"T_0d2fb_row3_col0\" class=\"data row3 col0\" >207838</td>\n","    </tr>\n","  </tbody>\n","</table>\n"],"text/plain":["<pandas.io.formats.style.Styler at 0x79bd6855c050>"]},"execution_count":45,"metadata":{},"output_type":"execute_result"}],"source":["tdcs_sampled_df['event'].value_counts().to_frame().style.background_gradient()"]},{"cell_type":"code","execution_count":46,"id":"78471751","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:02.66973Z","iopub.status.busy":"2023-12-14T11:41:02.668844Z","iopub.status.idle":"2023-12-14T11:41:02.873805Z","shell.execute_reply":"2023-12-14T11:41:02.872665Z"},"papermill":{"duration":0.233614,"end_time":"2023-12-14T11:41:02.876557","exception":false,"start_time":"2023-12-14T11:41:02.642943","status":"completed"},"tags":[]},"outputs":[],"source":["train_df = tdcs_sampled_df[['AccV','AccML','AccAP','event']]"]},{"cell_type":"code","execution_count":47,"id":"9fcd0cd5","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:02.929559Z","iopub.status.busy":"2023-12-14T11:41:02.928833Z","iopub.status.idle":"2023-12-14T11:41:03.222763Z","shell.execute_reply":"2023-12-14T11:41:03.221457Z"},"papermill":{"duration":0.323626,"end_time":"2023-12-14T11:41:03.22576","exception":false,"start_time":"2023-12-14T11:41:02.902134","status":"completed"},"tags":[]},"outputs":[],"source":["train_df['target'] = le.fit_transform(train_df['event'])"]},{"cell_type":"code","execution_count":48,"id":"55ee39c4","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:03.282237Z","iopub.status.busy":"2023-12-14T11:41:03.281498Z","iopub.status.idle":"2023-12-14T11:41:03.291444Z","shell.execute_reply":"2023-12-14T11:41:03.290423Z"},"papermill":{"duration":0.040986,"end_time":"2023-12-14T11:41:03.293869","exception":false,"start_time":"2023-12-14T11:41:03.252883","status":"completed"},"tags":[]},"outputs":[],"source":["X = train_df.drop(['event','target'], axis=1)\n","y = train_df['target']"]},{"cell_type":"code","execution_count":49,"id":"ead54b47","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:03.348834Z","iopub.status.busy":"2023-12-14T11:41:03.348427Z","iopub.status.idle":"2023-12-14T11:41:03.4137Z","shell.execute_reply":"2023-12-14T11:41:03.412784Z"},"papermill":{"duration":0.095538,"end_time":"2023-12-14T11:41:03.416494","exception":false,"start_time":"2023-12-14T11:41:03.320956","status":"completed"},"tags":[]},"outputs":[],"source":["# split dataset into training and test set\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=1004)\n"]},{"cell_type":"code","execution_count":50,"id":"77114c25","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:03.469712Z","iopub.status.busy":"2023-12-14T11:41:03.468897Z","iopub.status.idle":"2023-12-14T11:41:13.46428Z","shell.execute_reply":"2023-12-14T11:41:13.463286Z"},"papermill":{"duration":10.024305,"end_time":"2023-12-14T11:41:13.467178","exception":false,"start_time":"2023-12-14T11:41:03.442873","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<style type='text/css'>\n",".datatable table.frame { margin-bottom: 0; }\n",".datatable table.frame thead { border-bottom: none; }\n",".datatable table.frame tr.coltypes td {  color: #FFFFFF;  line-height: 6px;  padding: 0 0.5em;}\n",".datatable .bool    { background: #DDDD99; }\n",".datatable .object  { background: #565656; }\n",".datatable .int     { background: #5D9E5D; }\n",".datatable .float   { background: #4040CC; }\n",".datatable .str     { background: #CC4040; }\n",".datatable .time    { background: #40CC40; }\n",".datatable .row_index {  background: var(--jp-border-color3);  border-right: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  font-size: 9px;}\n",".datatable .frame tbody td { text-align: left; }\n",".datatable .frame tr.coltypes .row_index {  background: var(--jp-border-color0);}\n",".datatable th:nth-child(2) { padding-left: 12px; }\n",".datatable .hellipsis {  color: var(--jp-cell-editor-border-color);}\n",".datatable .vellipsis {  background: var(--jp-layout-color0);  color: var(--jp-cell-editor-border-color);}\n",".datatable .na {  color: var(--jp-cell-editor-border-color);  font-size: 80%;}\n",".datatable .sp {  opacity: 0.25;}\n",".datatable .footer { font-size: 9px; }\n",".datatable .frame_dimensions {  background: var(--jp-border-color3);  border-top: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  display: inline-block;  opacity: 0.6;  padding: 1px 10px 1px 5px;}\n",".datatable .frame thead tr.colnames {  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAA4CAYAAADuMJi0AAAGR0lEQVR42rVZ21IbRxBtCbQrkIR2dQVjsLmDLBsET3nTQ8ouYRkQVf6e/E9+Im958qMfkgoXAaKSSj6C9Jnd2R2NeiRSRaZqitVOT5+Z6dNnWoKGlN94JFp8Ipofkb/7SOXjGyp8wF+z35K3f0uUp/GW4XfLQ8v2gefj3ZCCzojoNfue+43o1Q3l3xB/yA3JO7jnF2pCLnI+pNyx/qw7L+SQ7T2N9p2f8c60QcfcK6KGXsAd+ZvA4LlZYuSSAoOhMs5vwJkEGDlbPMaJoA+FcQ0IH38QLWkbAFLkOOhoMF5tU6/eBRhNjro0ZgKiPRAt3FLhCO/vqdgmNTm32LkmKpvBmQY4q5uAaAgbwDBG2BVv3bfI8KKAMWj2kfw9+pkZREIbEql4ST1x7hgHIANkbJ//MF8mAH/ilTCJ2tIi4ASr1IC3VNqXHKOxjy34mgoImnOQtx1g81fkqTiMOBVGcTogNhiT5iBHET8R8C+iApJUmgim3SQAXhsLQz7ee2G8gOAQNtJckBEplADiAxtX+G9NmhDl0qJKnTvyWlAMPYZnvIviGXRg6/Dh824DBXhP/tbfREXJEIvQ+aaPGjG7pvw6r3xdx+9hqb4dgZaP2XmdHO2K/B0c1+oUph6k8kShBryl/Ft0DYgjTlOieOACHFFpVyUl72T9V3cM1jUoYvxIC2vpCSys/ck70mDYuYvdvKjlMdKAUThneWVU1aAsyjv6PURDiwNsHGBZzY+JtAAgE2TFxdRHJdyIp/f+zqu09M5cDP2F08Ukkpj4YNSdX950HY2pNCCUK/Hhx5ZMBfjNSEzdsIihVzzAMdn9dz4eDYhnyQb9SSCiAryiJcQk82LiTbJ4x2FZJaUenpKnzP95WyDf4Y+QN9EFHHSeDLGdBjjKNQ5vKHf4XMA7KrY0y0GEObBOO/8e1ywuQExOHXktuQyJALEBpcEqhwtHqgiDuCK5b6i0p2MQpcckIIoh+6hYgTZtO8xlMi6O4tKCF/kOGHEg/W0UUpHW0ZoGNZ1ExZWcn7EErgwt4uj50E/sFBjXXIayWvh7WryjasxarZKssXon0zxvvkc32Q0bqbBCuZiKt9dWFysfQefeL29JYFaeztX6tePaZdz5mYx8+6Zq3Mk0wXECQxlhdzgS2wjBHju3j1RIgKyOMdNUE8X0+RAdbSapS11MRCv1SzUXmO6wGZe2SQYrv2MvCSWEv2VODE6DN7bz8ufypgQKW7uQskFTQHULLKyaEyrnlZbgOGLrV5qrn9U79jjm2HJmgkaVN98AfBub91lGPLZBqdroN5LYgjSu4zYZDDHXZOIPC691HqrWI1900I8qLzgKP4ft8DxEWigprPfrO+KcXno9gZz4jjGewWdUcpGCj0qVFuGPYbl2VturndZ2qRvlL8acDO6lF/DY/VjsFesiUK+ypJ+r/ep+cJkSQxEK4PG4WozgA75TYrDDqStE69K8/mzGEM+JXTeqvmedEElMmwCMm2SLd6bNNF9su02zEtoW6nAQtpMj5Gd7fKa//wqonF7UdtHFsVn+6hf1o7AfriPH7M6EeIUEF5zKVxXbYo7kS/OEtOqDYZKPoBsETIixn0uYrasThmzDkhdKPkz2EnaX0HdQbIgr59vAdGYDqjHrxkjS7WOxkTD8sqEqhiwcJETgBYigrBqF08KyDaje9SZ/I1A7MzaTzMGDEulPtZUkuKcyIRAjxEJPVrnVlb/9wkfij31D/pQt1IN+iL8bGJcstBIO7Y5VI/cwDqURbXhMuJxBqD0KLoK3esWFs0Jz5i5ZvJUAfFJMFb9XmGIOnzGpijpcWYCaMqXSQWp8EnCABepQ0Elyi4wfKfsw78ikIqif1pe1AGPlLmojl1SKxHHXp1L+Ut7AmDQHvhI5xHGi4EooO2BR7k78PEkJOdL7cAxQUZ/Tyclu9gnfwGgOmm2lNHGNmZXsq4Pqgc1EG1ATrvKl8s4R9ywwnqulGUnaRLVhxy8v3ieUwy2hbooT68uscW++DCDH0WSzuoyN2D4LUJ/tLECbcSKznwMIFs0ChF4mRTCnQbIIfk4SHJo6A9BMuTnXTs3Ku/KxsgZWqzuSe+Os8cEUfnMBY6UF5gi3SUbd5K7vDjq5WW0UENJlRsWn4sy21Er/E/AvPQSFHy1p4fgAAAAASUVORK5CYII=');  background-repeat: repeat-x;  background-size: 14px;  height: 28px;}\n","</style>\n"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{},"output_type":"display_data"}],"source":["# LGBM\n","from lightgbm import LGBMClassifier\n","\n","# Initialize the LightGBM classifier\n","lgbm_classifier = LGBMClassifier(n_estimators=100, learning_rate=0.1, max_depth=3, random_state=42)\n","\n","# Train the classifier\n","lgbm_classifier.fit(X_train, y_train)\n","\n","# Make predictions on the test set\n","y_pred_2 = lgbm_classifier.predict(X_test)"]},{"cell_type":"code","execution_count":51,"id":"a96def7d","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:13.520952Z","iopub.status.busy":"2023-12-14T11:41:13.52055Z","iopub.status.idle":"2023-12-14T11:41:13.846174Z","shell.execute_reply":"2023-12-14T11:41:13.844473Z"},"papermill":{"duration":0.355282,"end_time":"2023-12-14T11:41:13.849086","exception":false,"start_time":"2023-12-14T11:41:13.493804","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy: 0.463833139874061\n","Confusion Matrix:\n","[[24425  6427  7997  2331]\n"," [ 3581 19358  8500  9968]\n"," [ 8901  9119 16755  6878]\n"," [ 5348 12356  7743 16584]]\n","Classification Report:\n","              precision    recall  f1-score   support\n","\n","           0       0.58      0.59      0.59     41180\n","           1       0.41      0.47      0.44     41407\n","           2       0.41      0.40      0.41     41653\n","           3       0.46      0.39      0.43     42031\n","\n","    accuracy                           0.46    166271\n","   macro avg       0.47      0.46      0.46    166271\n","weighted avg       0.46      0.46      0.46    166271\n","\n"]}],"source":["evaluate_metrics(y_test, y_pred_2)"]},{"cell_type":"code","execution_count":52,"id":"01c03db7","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:13.902491Z","iopub.status.busy":"2023-12-14T11:41:13.902106Z","iopub.status.idle":"2023-12-14T11:41:13.941134Z","shell.execute_reply":"2023-12-14T11:41:13.940184Z"},"papermill":{"duration":0.067861,"end_time":"2023-12-14T11:41:13.943752","exception":false,"start_time":"2023-12-14T11:41:13.875891","status":"completed"},"tags":[]},"outputs":[],"source":["test_tdcsfog_path = '/kaggle/input/tlvmc-parkinsons-freezing-gait-prediction/test/tdcsfog/003f117e14.csv'\n","test_tdcsfog = pd.read_csv(test_tdcsfog_path)\n","name = os.path.basename(test_tdcsfog_path)\n","id_value = name.split('.')[0]\n","test_tdcsfog['Id_value'] = id_value\n","test_tdcsfog['Id'] = test_tdcsfog['Id_value'].astype(str) + '_' + test_tdcsfog['Time'].astype(str)\n","test_tdcsfog = test_tdcsfog[['Id','AccV','AccML','AccAP']]\n","test_tdcsfog.set_index('Id',inplace=True)"]},{"cell_type":"code","execution_count":53,"id":"af5ea72a","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:13.996877Z","iopub.status.busy":"2023-12-14T11:41:13.996494Z","iopub.status.idle":"2023-12-14T11:41:14.011043Z","shell.execute_reply":"2023-12-14T11:41:14.010037Z"},"papermill":{"duration":0.043098,"end_time":"2023-12-14T11:41:14.013622","exception":false,"start_time":"2023-12-14T11:41:13.970524","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>AccV</th>\n","      <th>AccML</th>\n","      <th>AccAP</th>\n","    </tr>\n","    <tr>\n","      <th>Id</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>003f117e14_0</th>\n","      <td>-9.533939</td>\n","      <td>0.566322</td>\n","      <td>-1.413525</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_1</th>\n","      <td>-9.536140</td>\n","      <td>0.564137</td>\n","      <td>-1.440621</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_2</th>\n","      <td>-9.529345</td>\n","      <td>0.561765</td>\n","      <td>-1.429332</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_3</th>\n","      <td>-9.531239</td>\n","      <td>0.564227</td>\n","      <td>-1.415490</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_4</th>\n","      <td>-9.540825</td>\n","      <td>0.561854</td>\n","      <td>-1.429471</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_4677</th>\n","      <td>-9.351431</td>\n","      <td>0.370047</td>\n","      <td>-2.286318</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_4678</th>\n","      <td>-9.341410</td>\n","      <td>0.347721</td>\n","      <td>-2.321991</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_4679</th>\n","      <td>-9.350667</td>\n","      <td>0.361341</td>\n","      <td>-2.297158</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_4680</th>\n","      <td>-9.343977</td>\n","      <td>0.365726</td>\n","      <td>-2.292650</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_4681</th>\n","      <td>-9.348477</td>\n","      <td>0.379439</td>\n","      <td>-2.335422</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>4682 rows √ó 3 columns</p>\n","</div>"],"text/plain":["                     AccV     AccML     AccAP\n","Id                                           \n","003f117e14_0    -9.533939  0.566322 -1.413525\n","003f117e14_1    -9.536140  0.564137 -1.440621\n","003f117e14_2    -9.529345  0.561765 -1.429332\n","003f117e14_3    -9.531239  0.564227 -1.415490\n","003f117e14_4    -9.540825  0.561854 -1.429471\n","...                   ...       ...       ...\n","003f117e14_4677 -9.351431  0.370047 -2.286318\n","003f117e14_4678 -9.341410  0.347721 -2.321991\n","003f117e14_4679 -9.350667  0.361341 -2.297158\n","003f117e14_4680 -9.343977  0.365726 -2.292650\n","003f117e14_4681 -9.348477  0.379439 -2.335422\n","\n","[4682 rows x 3 columns]"]},"execution_count":53,"metadata":{},"output_type":"execute_result"}],"source":["test_tdcsfog"]},{"cell_type":"code","execution_count":54,"id":"9893d95c","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:14.067815Z","iopub.status.busy":"2023-12-14T11:41:14.067435Z","iopub.status.idle":"2023-12-14T11:41:14.11288Z","shell.execute_reply":"2023-12-14T11:41:14.111999Z"},"papermill":{"duration":0.075099,"end_time":"2023-12-14T11:41:14.115377","exception":false,"start_time":"2023-12-14T11:41:14.040278","status":"completed"},"tags":[]},"outputs":[],"source":["test_tdcsfog_pred=lgbm_classifier.predict(test_tdcsfog)\n","test_tdcsfog['event'] = test_tdcsfog_pred"]},{"cell_type":"code","execution_count":55,"id":"239456e3","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:14.170801Z","iopub.status.busy":"2023-12-14T11:41:14.170395Z","iopub.status.idle":"2023-12-14T11:41:14.188155Z","shell.execute_reply":"2023-12-14T11:41:14.186947Z"},"papermill":{"duration":0.0477,"end_time":"2023-12-14T11:41:14.190825","exception":false,"start_time":"2023-12-14T11:41:14.143125","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>AccV</th>\n","      <th>AccML</th>\n","      <th>AccAP</th>\n","      <th>event</th>\n","    </tr>\n","    <tr>\n","      <th>Id</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>003f117e14_0</th>\n","      <td>-9.533939</td>\n","      <td>0.566322</td>\n","      <td>-1.413525</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_1</th>\n","      <td>-9.536140</td>\n","      <td>0.564137</td>\n","      <td>-1.440621</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_2</th>\n","      <td>-9.529345</td>\n","      <td>0.561765</td>\n","      <td>-1.429332</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_3</th>\n","      <td>-9.531239</td>\n","      <td>0.564227</td>\n","      <td>-1.415490</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_4</th>\n","      <td>-9.540825</td>\n","      <td>0.561854</td>\n","      <td>-1.429471</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_4677</th>\n","      <td>-9.351431</td>\n","      <td>0.370047</td>\n","      <td>-2.286318</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_4678</th>\n","      <td>-9.341410</td>\n","      <td>0.347721</td>\n","      <td>-2.321991</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_4679</th>\n","      <td>-9.350667</td>\n","      <td>0.361341</td>\n","      <td>-2.297158</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_4680</th>\n","      <td>-9.343977</td>\n","      <td>0.365726</td>\n","      <td>-2.292650</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>003f117e14_4681</th>\n","      <td>-9.348477</td>\n","      <td>0.379439</td>\n","      <td>-2.335422</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>4682 rows √ó 4 columns</p>\n","</div>"],"text/plain":["                     AccV     AccML     AccAP  event\n","Id                                                  \n","003f117e14_0    -9.533939  0.566322 -1.413525      0\n","003f117e14_1    -9.536140  0.564137 -1.440621      0\n","003f117e14_2    -9.529345  0.561765 -1.429332      0\n","003f117e14_3    -9.531239  0.564227 -1.415490      0\n","003f117e14_4    -9.540825  0.561854 -1.429471      0\n","...                   ...       ...       ...    ...\n","003f117e14_4677 -9.351431  0.370047 -2.286318      0\n","003f117e14_4678 -9.341410  0.347721 -2.321991      0\n","003f117e14_4679 -9.350667  0.361341 -2.297158      0\n","003f117e14_4680 -9.343977  0.365726 -2.292650      0\n","003f117e14_4681 -9.348477  0.379439 -2.335422      0\n","\n","[4682 rows x 4 columns]"]},"execution_count":55,"metadata":{},"output_type":"execute_result"}],"source":["test_tdcsfog"]},{"cell_type":"code","execution_count":56,"id":"1af1627c","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:14.246563Z","iopub.status.busy":"2023-12-14T11:41:14.24614Z","iopub.status.idle":"2023-12-14T11:41:14.256404Z","shell.execute_reply":"2023-12-14T11:41:14.25538Z"},"papermill":{"duration":0.041295,"end_time":"2023-12-14T11:41:14.258856","exception":false,"start_time":"2023-12-14T11:41:14.217561","status":"completed"},"tags":[]},"outputs":[],"source":["test_tdcsfog['StartHesitation'] = np.where(test_tdcsfog['event']==1, 1, 0)\n","test_tdcsfog['Turn'] = np.where(test_tdcsfog['event']==2, 1, 0)\n","test_tdcsfog['Walking'] = np.where(test_tdcsfog['event']==3, 1, 0)\n","test_tdcsfog.reset_index('Id', inplace=True)"]},{"cell_type":"code","execution_count":57,"id":"f6283e32","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:14.31553Z","iopub.status.busy":"2023-12-14T11:41:14.314689Z","iopub.status.idle":"2023-12-14T11:41:14.334308Z","shell.execute_reply":"2023-12-14T11:41:14.333112Z"},"papermill":{"duration":0.050305,"end_time":"2023-12-14T11:41:14.336816","exception":false,"start_time":"2023-12-14T11:41:14.286511","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Id</th>\n","      <th>AccV</th>\n","      <th>AccML</th>\n","      <th>AccAP</th>\n","      <th>event</th>\n","      <th>StartHesitation</th>\n","      <th>Turn</th>\n","      <th>Walking</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>003f117e14_0</td>\n","      <td>-9.533939</td>\n","      <td>0.566322</td>\n","      <td>-1.413525</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>003f117e14_1</td>\n","      <td>-9.536140</td>\n","      <td>0.564137</td>\n","      <td>-1.440621</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>003f117e14_2</td>\n","      <td>-9.529345</td>\n","      <td>0.561765</td>\n","      <td>-1.429332</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>003f117e14_3</td>\n","      <td>-9.531239</td>\n","      <td>0.564227</td>\n","      <td>-1.415490</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>003f117e14_4</td>\n","      <td>-9.540825</td>\n","      <td>0.561854</td>\n","      <td>-1.429471</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>4677</th>\n","      <td>003f117e14_4677</td>\n","      <td>-9.351431</td>\n","      <td>0.370047</td>\n","      <td>-2.286318</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4678</th>\n","      <td>003f117e14_4678</td>\n","      <td>-9.341410</td>\n","      <td>0.347721</td>\n","      <td>-2.321991</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4679</th>\n","      <td>003f117e14_4679</td>\n","      <td>-9.350667</td>\n","      <td>0.361341</td>\n","      <td>-2.297158</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4680</th>\n","      <td>003f117e14_4680</td>\n","      <td>-9.343977</td>\n","      <td>0.365726</td>\n","      <td>-2.292650</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4681</th>\n","      <td>003f117e14_4681</td>\n","      <td>-9.348477</td>\n","      <td>0.379439</td>\n","      <td>-2.335422</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>4682 rows √ó 8 columns</p>\n","</div>"],"text/plain":["                   Id      AccV     AccML     AccAP  event  StartHesitation  \\\n","0        003f117e14_0 -9.533939  0.566322 -1.413525      0                0   \n","1        003f117e14_1 -9.536140  0.564137 -1.440621      0                0   \n","2        003f117e14_2 -9.529345  0.561765 -1.429332      0                0   \n","3        003f117e14_3 -9.531239  0.564227 -1.415490      0                0   \n","4        003f117e14_4 -9.540825  0.561854 -1.429471      0                0   \n","...               ...       ...       ...       ...    ...              ...   \n","4677  003f117e14_4677 -9.351431  0.370047 -2.286318      0                0   \n","4678  003f117e14_4678 -9.341410  0.347721 -2.321991      0                0   \n","4679  003f117e14_4679 -9.350667  0.361341 -2.297158      0                0   \n","4680  003f117e14_4680 -9.343977  0.365726 -2.292650      0                0   \n","4681  003f117e14_4681 -9.348477  0.379439 -2.335422      0                0   \n","\n","      Turn  Walking  \n","0        0        0  \n","1        0        0  \n","2        0        0  \n","3        0        0  \n","4        0        0  \n","...    ...      ...  \n","4677     0        0  \n","4678     0        0  \n","4679     0        0  \n","4680     0        0  \n","4681     0        0  \n","\n","[4682 rows x 8 columns]"]},"execution_count":57,"metadata":{},"output_type":"execute_result"}],"source":["test_tdcsfog"]},{"cell_type":"code","execution_count":58,"id":"a168868d","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:14.391407Z","iopub.status.busy":"2023-12-14T11:41:14.391082Z","iopub.status.idle":"2023-12-14T11:41:14.397579Z","shell.execute_reply":"2023-12-14T11:41:14.396522Z"},"papermill":{"duration":0.03606,"end_time":"2023-12-14T11:41:14.399909","exception":false,"start_time":"2023-12-14T11:41:14.363849","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["(4682, 8)"]},"execution_count":58,"metadata":{},"output_type":"execute_result"}],"source":["test_tdcsfog.shape"]},{"cell_type":"code","execution_count":59,"id":"e350a9de","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:14.455581Z","iopub.status.busy":"2023-12-14T11:41:14.455258Z","iopub.status.idle":"2023-12-14T11:41:14.464829Z","shell.execute_reply":"2023-12-14T11:41:14.463808Z"},"papermill":{"duration":0.040342,"end_time":"2023-12-14T11:41:14.467285","exception":false,"start_time":"2023-12-14T11:41:14.426943","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["0    2043\n","1    1452\n","2     979\n","3     208\n","Name: event, dtype: int64 \n","\n","0    3230\n","1    1452\n","Name: StartHesitation, dtype: int64 \n","\n","0    3703\n","1     979\n","Name: Turn, dtype: int64 \n","\n","0    4474\n","1     208\n","Name: Walking, dtype: int64 \n","\n"]}],"source":["print(test_tdcsfog['event'].value_counts(),'\\n')\n","print(test_tdcsfog['StartHesitation'].value_counts(),'\\n')\n","print(test_tdcsfog['Turn'].value_counts(),'\\n')\n","print(test_tdcsfog['Walking'].value_counts(),'\\n')"]},{"cell_type":"code","execution_count":60,"id":"648f0627","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:14.522327Z","iopub.status.busy":"2023-12-14T11:41:14.521972Z","iopub.status.idle":"2023-12-14T11:41:14.549384Z","shell.execute_reply":"2023-12-14T11:41:14.548468Z"},"papermill":{"duration":0.058959,"end_time":"2023-12-14T11:41:14.552084","exception":false,"start_time":"2023-12-14T11:41:14.493125","status":"completed"},"tags":[]},"outputs":[],"source":["submit = pd.concat([test_tdcsfog,test_defog])\n","submit = submit[['Id', 'StartHesitation', 'Turn','Walking']]"]},{"cell_type":"code","execution_count":61,"id":"ba8b038f","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:14.60894Z","iopub.status.busy":"2023-12-14T11:41:14.608243Z","iopub.status.idle":"2023-12-14T11:41:14.924176Z","shell.execute_reply":"2023-12-14T11:41:14.923229Z"},"papermill":{"duration":0.346958,"end_time":"2023-12-14T11:41:14.926759","exception":false,"start_time":"2023-12-14T11:41:14.579801","status":"completed"},"tags":[]},"outputs":[],"source":["submit.to_csv('/kaggle/working/submission.csv', index=False)"]},{"cell_type":"code","execution_count":62,"id":"b4d47efe","metadata":{"execution":{"iopub.execute_input":"2023-12-14T11:41:14.981619Z","iopub.status.busy":"2023-12-14T11:41:14.981212Z","iopub.status.idle":"2023-12-14T11:41:15.054434Z","shell.execute_reply":"2023-12-14T11:41:15.05339Z"},"papermill":{"duration":0.103903,"end_time":"2023-12-14T11:41:15.057178","exception":false,"start_time":"2023-12-14T11:41:14.953275","status":"completed"},"tags":[]},"outputs":[],"source":["sample = pd.read_csv('/kaggle/working/submission.csv')"]}],"metadata":{"kaggle":{"accelerator":"gpu","dataSources":[{"databundleVersionId":5677426,"sourceId":41880,"sourceType":"competition"}],"dockerImageVersionId":30408,"isGpuEnabled":true,"isInternetEnabled":false,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.12"},"papermill":{"default_parameters":{},"duration":243.148845,"end_time":"2023-12-14T11:41:16.410437","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2023-12-14T11:37:13.261592","version":"2.4.0"}},"nbformat":4,"nbformat_minor":5}